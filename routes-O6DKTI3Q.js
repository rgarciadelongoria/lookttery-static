var l=(e,g,t)=>new Promise((i,o)=>{var s=y=>{try{x(t.next(y))}catch(Y){o(Y)}},m=y=>{try{x(t.throw(y))}catch(Y){o(Y)}},x=y=>y.done?i(y.value):Promise.resolve(y.value).then(s,m);x((t=t.apply(e,g)).next())});import{CommonModule as Rt}from"@angular/common";import"@angular/core";import{RouterModule as Bt}from"@angular/router";import{IonicModule as Ht}from"@ionic/angular";var J=function(e){return e.SHELL_VERSION="shellVersion",e}(J||{}),D=function(e){return e.SHELL_DEVICE_GET_ID="shellDeviceGetId",e.SHELL_SCANNER_RESPONSE="shellScannerResponse",e.SHELL_SCANNER_START="shellScannerStart",e.SHELL_SCANNER_STOP="shellScannerStop",e.SHELL_SCANNER_ERROR="shellScannerError",e.SHELL_DEVICE_GET_ID_RESPONSE="shellDeviceGetIdResponse",e}(D||{}),Z=function(e){return e.SHELL_LOADING_REMOTE_OK="shellLoadingRemoteOk",e}(Z||{});var p=function(e){return e.TOKEN="token",e.APP_UUID="appUuid",e.LANGUAGE="language",e}(p||{}),M=function(e){return e.EN="en",e.ES="es",e}(M||{}),w=function(e){return e.SYSTEM="[SYSTEM]",e}(w||{}),_=function(e){return e.UUID_EMAIL_DOMAIN="@uuid.app",e.UUID_QR_CODE="app-uuid-code:",e.GAME_CODES="GameCodes",e}(_||{}),X=function(e){return e.LOTERIA_NACIONAL="ln",e}(X||{}),b=function(e){return e.CANCEL="CANCEL",e.ACCEPT="ACCEPT",e}(b||{});import{TranslateModule as Gt}from"@ngx-translate/core";import*as n from"@angular/core";import*as ft from"@angular/router";import"@angular/core";var S={api:{host:"https://api.lookttery.com/api"},web:{host:"https://lookttery.com"}};import{lastValueFrom as st}from"rxjs";import*as L from"@angular/core";import*as ct from"@ionic/angular";import*as lt from"@ngx-translate/core";import{HttpHeaders as Pt}from"@angular/common/http";import"@angular/core";import{catchError as At}from"rxjs";import*as O from"@angular/core";import*as ot from"@angular/common/http";import*as rt from"@angular/router";import"@angular/core";import*as nt from"@angular/core";var C=(()=>{class e{constructor(){}setItem(t,i){localStorage.setItem(t,i)}getItem(t){try{return JSON.parse(localStorage.getItem(t)||"")}catch{return localStorage.getItem(t)}}removeItem(t){localStorage.removeItem(t)}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=nt.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var at=function(e){return e.UNAUTHORIZED="Unauthorized",e}(at||{}),I=(()=>{class e{constructor(t,i,o){this.http=t,this.router=i,this.storageSrv=o}get(t,i){return i=this.addTokenToHeaders(i),this.http.get(t,i)}post(t,i,o){return o=this.addPostHeaders(o),o=this.addTokenToHeaders(o),this.http.post(t,i,o).pipe(this.handleErrorAndRedirect())}delete(t,i){return i=this.addTokenToHeaders(i),this.http.delete(t,i)}addTokenToHeaders(t){let o=[["Authorization",`Bearer ${this.storageSrv.getItem(p.TOKEN)?.token}`]];return this.addHeaders(o,t)}addPostHeaders(t){let i=[["Content-Type","application/json"]];return this.addHeaders(i,t)}addHeaders(t,i){return t.forEach(o=>{i=i||{},i.headers=i.headers||{},i.headers instanceof Pt?i.headers=i.headers.append(o[0],o[1]):typeof i.headers=="object"&&(i.headers[o[0]]=o[1])}),i||{}}handleErrorAndRedirect(){return At((t,i)=>l(this,null,function*(){throw t.status===401&&t.statusText===at.UNAUTHORIZED&&(this.storageSrv.removeItem(p.TOKEN),this.router.navigate(["/","main"])),t}))}static{this.\u0275fac=function(i){return new(i||e)(O.\u0275\u0275inject(ot.HttpClient),O.\u0275\u0275inject(rt.Router),O.\u0275\u0275inject(C))}}static{this.\u0275prov=O.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var P=(()=>{class e{constructor(t,i,o){this.alertController=t,this.translateSrv=i,this.apiSrv=o,this.apiTicket=`${S.api.host}/ticket`}createNewTicket(t){return l(this,null,function*(){let i={data:{info:{code:t}}};try{let o=yield this.apiSrv.post(this.apiTicket,i);return yield st(o)}catch(o){throw o}})}deleteTicketById(t,i=!1){return l(this,null,function*(){let o=b.ACCEPT;if(i&&(o=yield this.presentAlertConfirmDeleteTicket()),o===b.ACCEPT)try{let s=yield this.apiSrv.delete(`${this.apiTicket}/${t}`);return yield st(s)}catch(s){throw s}})}presentAlertConfirmDeleteTicket(){return l(this,null,function*(){let t=yield this.alertController.create({header:this.translateSrv.instant("TICKETS.DELETE_TICKET"),subHeader:this.translateSrv.instant("GLOBAL.IRREVERSIBLE_ACTION"),message:this.translateSrv.instant("TICKETS.DELETE_TICKET_QUESTION"),buttons:[{text:this.translateSrv.instant("GLOBAL.CANCEL"),role:b.CANCEL,handler:()=>{}},{text:this.translateSrv.instant("GLOBAL.ACCEPT"),role:b.ACCEPT,handler:()=>{}}]});yield t.present();let{role:i}=yield t.onDidDismiss();return i})}static{this.\u0275fac=function(i){return new(i||e)(L.\u0275\u0275inject(ct.AlertController),L.\u0275\u0275inject(lt.TranslateService),L.\u0275\u0275inject(I))}}static{this.\u0275prov=L.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();import"@angular/core";import{lastValueFrom as dt}from"rxjs";import{v4 as Nt}from"uuid";import*as A from"@angular/core";import"@angular/core";import{lastValueFrom as tt}from"rxjs";import*as R from"@angular/core";var Ut=1e3*60*60*1.5,k=(()=>{class e{constructor(t,i){this.apiSrv=t,this.storageSrv=i,this.apiUser=`${S.api.host}/user`}createUserByUuid(t){return l(this,null,function*(){let i={email:`${t}${_.UUID_EMAIL_DOMAIN}`,password:t,name:t};try{let o=this.apiSrv.post(this.apiUser,i);return yield tt(o)}catch(o){throw o}})}loginByUuid(t){return l(this,null,function*(){return yield this.login(`${t}${_.UUID_EMAIL_DOMAIN}`,t)})}login(t,i){return l(this,null,function*(){let o={email:t,password:i};try{let s=this.apiSrv.post(`${this.apiUser}/login`,o),m=yield tt(s);if(m.token){let x={token:m.token,date:Date.now()};this.storageSrv.setItem(p.TOKEN,JSON.stringify(x)),console.info(w.SYSTEM,`${m.token}`)}return m}catch(s){throw s}})}checkTokenExpiration(t){return l(this,null,function*(){let o=this.storageSrv.getItem(p.TOKEN)?.date||0;Date.now()-o>Ut&&(yield this.loginByUuid(t))})}getAllTicketsByUser(){return l(this,null,function*(){try{let t=this.apiSrv.get(`${this.apiUser}/ticket/all?limit=100&offset=0`);return yield tt(t)}catch{return[]}})}static{this.\u0275fac=function(i){return new(i||e)(R.\u0275\u0275inject(I),R.\u0275\u0275inject(C))}}static{this.\u0275prov=R.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();import"@angular/core";import*as H from"@angular/core";var pt=(()=>{class e{constructor(t){this.storageSrv=t}hasShell(){return this.storageSrv.getItem(J.SHELL_VERSION)==="0.0.0"}static{this.\u0275fac=function(i){return new(i||e)(H.\u0275\u0275inject(C))}}static{this.\u0275prov=H.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var T=(()=>{class e{constructor(t,i,o){this.apiSrv=t,this.userSrv=i,this.coreSrv=o,this.uuid="",this.apiUuid=`${S.api.host}/uuid`,window.addEventListener(D.SHELL_DEVICE_GET_ID_RESPONSE,s=>l(this,null,function*(){let m=localStorage.getItem(p.APP_UUID)||s.detail?.response||"";this.setAppUuid(m),yield this.onDeviceIdResponse()}))}init(){return l(this,null,function*(){yield this.requestDeviceId()})}getUuid(){return this.uuid}updateAppUuid(t){this.setAppUuid(t)}requestDeviceId(){return l(this,null,function*(){if(this.coreSrv.hasShell())window.dispatchEvent(new CustomEvent(D.SHELL_DEVICE_GET_ID));else{let t=localStorage.getItem(p.APP_UUID)||"";this.setAppUuid(t),yield this.onDeviceIdResponse()}})}setAppUuid(t){this.uuid=t,this.uuid||(this.uuid=Nt()),localStorage.setItem(p.APP_UUID,this.uuid)}onDeviceIdResponse(){return l(this,null,function*(){(yield this.getUuidData())?(yield this.userSrv.loginByUuid(this.uuid),console.info(w.SYSTEM,`UUID ${this.uuid} was registered.`)):yield this.registerUuid()})}getUuidData(){return l(this,null,function*(){try{let t=this.apiSrv.get(`${this.apiUuid}/${this.uuid}`);return yield dt(t)}catch{return null}})}registerUuid(){return l(this,null,function*(){let t=yield this.userSrv.createUserByUuid(this.uuid);if((yield this.userSrv.loginByUuid(this.uuid)).token){let o={uuid:this.uuid,user:t._id};try{let s=this.apiSrv.post(this.apiUuid,o),m=yield dt(s);this.uuid=m.uuid,console.info(w.SYSTEM,`UUID ${this.uuid} has been registered.`)}catch(s){console.error(s)}}})}static{this.\u0275fac=function(i){return new(i||e)(A.\u0275\u0275inject(I),A.\u0275\u0275inject(k),A.\u0275\u0275inject(pt))}}static{this.\u0275prov=A.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();import"@angular/core";import{lastValueFrom as ut}from"rxjs";import*as G from"@angular/core";var U=(()=>{class e{constructor(t){this.apiSrv=t,this.apiGame=`${S.api.host}/game`}getAllTicketsPrizesByUser(){return l(this,null,function*(){try{let t=this.apiSrv.get(`${this.apiGame}/ticket/all?limit=100&offset=0`);return yield ut(t)}catch{return[]}})}getTicketPrizeByTicketId(t){return l(this,null,function*(){try{let i=this.apiSrv.get(`${this.apiGame}/ticket/${t}`);return yield ut(i)}catch{return null}})}static{this.\u0275fac=function(i){return new(i||e)(G.\u0275\u0275inject(I))}}static{this.\u0275prov=G.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();import*as d from"@ionic/angular";import*as $ from"@ngx-translate/core";import*as gt from"@angular/common";var $t=["ticketInfoModal"];function Vt(e,g){e&1&&(n.\u0275\u0275elementStart(0,"article"),n.\u0275\u0275text(1,"Camera permission denied."),n.\u0275\u0275elementEnd())}function Ft(e,g){e&1&&n.\u0275\u0275element(0,"ion-icon",4)}function zt(e,g){e&1&&(n.\u0275\u0275text(0),n.\u0275\u0275pipe(1,"translate")),e&2&&n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(1,1,"GAMES.LN")," ")}function Kt(e,g){if(e&1&&(n.\u0275\u0275elementStart(0,"article",10)(1,"span",11),n.\u0275\u0275text(2),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(3,"span",12),n.\u0275\u0275text(4),n.\u0275\u0275pipe(5,"currency"),n.\u0275\u0275elementEnd()()),e&2){let t=n.\u0275\u0275nextContext(2);n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate(t.ticketData==null||t.ticketData.prize==null?null:t.ticketData.prize.number),n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate(n.\u0275\u0275pipeBind2(5,2,t.ticketData==null||t.ticketData.prize==null?null:t.ticketData.prize.quantity,"EUR"))}}function Qt(e,g){e&1&&(n.\u0275\u0275elementStart(0,"p"),n.\u0275\u0275text(1,"Game not available"),n.\u0275\u0275elementEnd())}function qt(e,g){if(e&1){let t=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),n.\u0275\u0275template(3,zt,2,3),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(4,"ion-buttons",5)(5,"ion-icon",6),n.\u0275\u0275listener("click",function(){n.\u0275\u0275restoreView(t);let o=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(o.closeTicketInfoModal())}),n.\u0275\u0275elementEnd()()()(),n.\u0275\u0275elementStart(6,"ion-content",7)(7,"section",8),n.\u0275\u0275template(8,Kt,6,5,"article",9)(9,Qt,2,0),n.\u0275\u0275elementEnd()()}if(e&2){let t=n.\u0275\u0275nextContext();n.\u0275\u0275advance(3),n.\u0275\u0275conditional(3,(t.ticketData==null||t.ticketData.ticket==null?null:t.ticketData.ticket.code)===t.gameCodes.LOTERIA_NACIONAL?3:-1),n.\u0275\u0275advance(5),n.\u0275\u0275conditional(8,(t.ticketData==null||t.ticketData.ticket==null?null:t.ticketData.ticket.code)===t.gameCodes.LOTERIA_NACIONAL?8:9)}}var St=(()=>{class e{handleShellScannerResponse(t){return l(this,null,function*(){yield this.onScannerResponse(t.detail?.response||{})})}handleShellScannerError(t){return l(this,null,function*(){yield this.onScannerError(t.detail?.response||{})})}constructor(t,i,o,s,m,x,y){this.router=t,this.ticketSrv=i,this.uuidSrv=o,this.userSrv=s,this.gameSrv=m,this.loadingCtrl=x,this.translateSrv=y,this.gameCodes=X,this.hasShell=!1,this.responses=[],this.hasPermission=!0,this.ticketData=null,this.isTicketInfoModalOpen=!1}ngOnInit(){}ionViewDidEnter(){return l(this,null,function*(){yield this.startScan()})}ionViewWillLeave(){this.stopScan()}startScan(t){return l(this,null,function*(){this.hasPermission=!0,window.dispatchEvent(new CustomEvent(D.SHELL_SCANNER_START))})}stopScan(t){window.dispatchEvent(new CustomEvent(D.SHELL_SCANNER_STOP))}permissionResponse(t){this.hasPermission=t||!1}closeTicketInfoModal(){return l(this,null,function*(){yield this.ticketInfoModal.dismiss()})}onScannerResponse(t){return l(this,null,function*(){if(!this.isTicketInfoModalOpen){if(this.checkUuidQRCode(t.content||"")){let i=t.content.toString().replace(_.UUID_QR_CODE,"");this.uuidSrv.updateAppUuid(i),yield this.userSrv.loginByUuid(i)}else if(t&&!t.closed){this.showLoading();let i="";try{i=(yield this.ticketSrv.createNewTicket(t.content||""))._id||""}catch(s){i=s.error?.ticket?._id||""}this.ticketData=yield this.gameSrv.getTicketPrizeByTicketId(i),this.dismissLoading(),yield this.ticketInfoModal.present();let o=yield this.ticketInfoModal.onWillDismiss();this.startScan()}}})}onScannerError(t){return l(this,null,function*(){console.log(t),this.hasPermission=!1})}checkUuidQRCode(t){return!!t.toString().includes(_.UUID_QR_CODE)}showLoading(){return l(this,null,function*(){(yield this.loadingCtrl.create({message:this.translateSrv.instant("TICKETS.LOADING_TICKETS")})).present()})}dismissLoading(){return l(this,null,function*(){yield this.loadingCtrl.dismiss()})}static{this.\u0275fac=function(i){return new(i||e)(n.\u0275\u0275directiveInject(ft.Router),n.\u0275\u0275directiveInject(P),n.\u0275\u0275directiveInject(T),n.\u0275\u0275directiveInject(k),n.\u0275\u0275directiveInject(U),n.\u0275\u0275directiveInject(d.LoadingController),n.\u0275\u0275directiveInject($.TranslateService))}}static{this.\u0275cmp=n.\u0275\u0275defineComponent({type:e,selectors:[["app-scan"]],viewQuery:function(i,o){if(i&1&&n.\u0275\u0275viewQuery($t,5),i&2){let s;n.\u0275\u0275queryRefresh(s=n.\u0275\u0275loadQuery())&&(o.ticketInfoModal=s.first)}},hostBindings:function(i,o){i&1&&n.\u0275\u0275listener("shellScannerResponse",function(m){return o.handleShellScannerResponse(m)},!1,n.\u0275\u0275resolveWindow)("shellScannerError",function(m){return o.handleShellScannerError(m)},!1,n.\u0275\u0275resolveWindow)},standalone:!0,features:[n.\u0275\u0275StandaloneFeature],decls:7,vars:1,consts:[[1,"scan"],[1,"scan-screen"],[3,"ionModalWillPresent","ionModalWillDismiss"],["ticketInfoModal",""],["name","add-outline",1,"scan-screen-pointer"],["slot","end"],["name","close","size","large",3,"click"],[1,"ion-padding"],[1,"ticket"],["class","ticket-ln"],[1,"ticket-ln"],[1,"ticket-ln-number"],[1,"ticket-ln-prize"]],template:function(i,o){i&1&&(n.\u0275\u0275elementStart(0,"section",0)(1,"section",1),n.\u0275\u0275template(2,Vt,2,0,"article")(3,Ft,1,0),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(4,"ion-modal",2,3),n.\u0275\u0275listener("ionModalWillPresent",function(){return o.isTicketInfoModalOpen=!0})("ionModalWillDismiss",function(){return o.isTicketInfoModalOpen=!1}),n.\u0275\u0275template(6,qt,10,2,"ng-template"),n.\u0275\u0275elementEnd()),i&2&&(n.\u0275\u0275advance(2),n.\u0275\u0275conditional(2,o.hasPermission?3:2))},dependencies:[Rt,gt.CurrencyPipe,Bt,Ht,d.IonButtons,d.IonContent,d.IonHeader,d.IonIcon,d.IonTitle,d.IonToolbar,d.IonModal,Gt,$.TranslatePipe],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   .scan[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:flex-start;height:100vh;margin:0}[_nghost-%COMP%]   .scan-screen[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%}[_nghost-%COMP%]   .scan-screen-pointer[_ngcontent-%COMP%]{width:40px;color:#fff;height:40px}ion-modal[_ngcontent-%COMP%]{--height: 200px;--border-radius: 8px;--box-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1)}ion-modal[_ngcontent-%COMP%]   .ticket-ln[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}ion-modal[_ngcontent-%COMP%]   .ticket-ln-number[_ngcontent-%COMP%]{font-size:40px;font-weight:700;letter-spacing:17px;margin:20px 20px 20px 37px}ion-modal[_ngcontent-%COMP%]   .ticket-ln-prize[_ngcontent-%COMP%]{font-size:20px;font-weight:700}ion-modal[_ngcontent-%COMP%]::part(content){margin:20px}"],changeDetection:0})}}return e})();import{CommonModule as Wt}from"@angular/common";import"@angular/core";import{RouterModule as Yt}from"@angular/router";import{IonicModule as Jt}from"@ionic/angular";import{TranslateModule as Zt}from"@ngx-translate/core";import*as c from"@angular/core";import*as vt from"@angular/router";import*as E from"@ionic/angular";import*as Ct from"@ngx-translate/core";var Xt=["mainTabs"],It=(()=>{class e{constructor(t){this.router=t}ngOnInit(){}ngAfterViewInit(){setTimeout(()=>{this.mainTabs.select("games")},500)}static{this.\u0275fac=function(i){return new(i||e)(c.\u0275\u0275directiveInject(vt.Router))}}static{this.\u0275cmp=c.\u0275\u0275defineComponent({type:e,selectors:[["app-main"]],viewQuery:function(i,o){if(i&1&&c.\u0275\u0275viewQuery(Xt,5),i&2){let s;c.\u0275\u0275queryRefresh(s=c.\u0275\u0275loadQuery())&&(o.mainTabs=s.first)}},standalone:!0,features:[c.\u0275\u0275StandaloneFeature],decls:23,vars:12,consts:[["mainTabs",""],["slot","bottom"],["tab","games"],["name","grid-outline"],["tab","scan"],["name","scan-outline"],["tab","tickets"],["name","wallet-outline"],["tab","menu"],["name","cog-outline"]],template:function(i,o){i&1&&(c.\u0275\u0275elementStart(0,"ion-tabs",null,0)(2,"ion-tab-bar",1)(3,"ion-tab-button",2),c.\u0275\u0275element(4,"ion-icon",3),c.\u0275\u0275elementStart(5,"span"),c.\u0275\u0275text(6),c.\u0275\u0275pipe(7,"translate"),c.\u0275\u0275elementEnd()(),c.\u0275\u0275elementStart(8,"ion-tab-button",4),c.\u0275\u0275element(9,"ion-icon",5),c.\u0275\u0275elementStart(10,"span"),c.\u0275\u0275text(11),c.\u0275\u0275pipe(12,"translate"),c.\u0275\u0275elementEnd()(),c.\u0275\u0275elementStart(13,"ion-tab-button",6),c.\u0275\u0275element(14,"ion-icon",7),c.\u0275\u0275elementStart(15,"span"),c.\u0275\u0275text(16),c.\u0275\u0275pipe(17,"translate"),c.\u0275\u0275elementEnd()(),c.\u0275\u0275elementStart(18,"ion-tab-button",8),c.\u0275\u0275element(19,"ion-icon",9),c.\u0275\u0275elementStart(20,"span"),c.\u0275\u0275text(21),c.\u0275\u0275pipe(22,"translate"),c.\u0275\u0275elementEnd()()()()),i&2&&(c.\u0275\u0275advance(6),c.\u0275\u0275textInterpolate(c.\u0275\u0275pipeBind1(7,4,"MAIN.TABS.GAMES")),c.\u0275\u0275advance(5),c.\u0275\u0275textInterpolate(c.\u0275\u0275pipeBind1(12,6,"MAIN.TABS.SCAN_NOW")),c.\u0275\u0275advance(5),c.\u0275\u0275textInterpolate(c.\u0275\u0275pipeBind1(17,8,"MAIN.TABS.TICKETS")),c.\u0275\u0275advance(5),c.\u0275\u0275textInterpolate(c.\u0275\u0275pipeBind1(22,10,"MAIN.TABS.MENU")))},dependencies:[Wt,Yt,Jt,E.IonIcon,E.IonTabBar,E.IonTabButton,E.IonTabs,Zt,Ct.TranslatePipe],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   ion-tab-bar[_ngcontent-%COMP%]{padding-bottom:var(--ion-statusbar-padding, 0)}"],changeDetection:0})}}return e})();import{CommonModule as ee}from"@angular/common";import{HttpClient as ie,HttpClientModule as ne}from"@angular/common/http";import"@angular/core";import{NavigationEnd as oe,RouterModule as re}from"@angular/router";import{filter as ae}from"rxjs";import{IonicModule as se}from"@ionic/angular";import{TranslateLoader as ce,TranslateModule as le}from"@ngx-translate/core";import"@angular/core";import{catchError as te}from"rxjs/operators";import*as V from"@angular/core";import*as yt from"@angular/common/http";var _t=(()=>{class e{constructor(t){this.httpClient=t}getTranslation(t){let i=S.web.host+`/assets/i18n/${t}.json`;return this.httpClient.get(i).pipe(te(o=>(console.log("Error loading translation file",o),this.httpClient.get(S.web.host+"/assets/i18n/es.json"))))}static{this.\u0275fac=function(i){return new(i||e)(V.\u0275\u0275inject(yt.HttpClient))}}static{this.\u0275prov=V.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac})}}return e})();import*as h from"@angular/core";import*as kt from"@ngx-translate/core";import*as F from"@angular/router";var Tt=(()=>{class e{constructor(t,i,o,s,m){this.translateSrv=t,this.uuidSrv=i,this.userSrv=o,this.storageSrv=s,this.router=m,this.translateSrv.setDefaultLang("en"),this.translateSrv.use("en")}ngOnInit(){this.setNoErrorLoadingRemote(),this.importStyles(),this.importScripts(),this.uuidSrv.init(),this.router.events.pipe(ae(t=>t instanceof oe)).subscribe(t=>{let i=this.uuidSrv.getUuid();i?this.userSrv.checkTokenExpiration(i):this.uuidSrv.init()}),this.loadLanguage()}loadLanguage(){let t=this.storageSrv.getItem(p.LANGUAGE)||M.EN;this.translateSrv.use(t)}setNoErrorLoadingRemote(){this.storageSrv.setItem(Z.SHELL_LOADING_REMOTE_OK,"true")}importScripts(){let t=["https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.esm.js","https://cdn.jsdelivr.net/npm/ionicons/dist/ionicons/ionicons.esm.js"],i=document.head;t.forEach(o=>{let s=document.createElement("script");s.type="module",s.src=o,s.async=!1,document.head.appendChild(s),i.insertBefore(s,i.firstElementChild)})}importStyles(){let t=["https://cdn.jsdelivr.net/npm/@ionic/core/css/ionic.bundle.css"],i=document.head;t.forEach(o=>{let s=document.createElement("link");s.rel="stylesheet",s.href=o,i.insertBefore(s,i.firstElementChild)})}static{this.\u0275fac=function(i){return new(i||e)(h.\u0275\u0275directiveInject(kt.TranslateService),h.\u0275\u0275directiveInject(T),h.\u0275\u0275directiveInject(k),h.\u0275\u0275directiveInject(C),h.\u0275\u0275directiveInject(F.Router))}}static{this.\u0275cmp=h.\u0275\u0275defineComponent({type:e,selectors:[["app-remote-app"]],standalone:!0,features:[h.\u0275\u0275ProvidersFeature([I,T,k,P,U,le.forRoot({loader:{provide:ce,useClass:_t,deps:[ie]}}).providers]),h.\u0275\u0275StandaloneFeature],decls:1,vars:0,template:function(i,o){i&1&&h.\u0275\u0275element(0,"router-outlet")},dependencies:[ee,re,F.RouterOutlet,se,ne],styles:[`:host{display:block}body{--ion-color-primary: #3880ff;--ion-color-primary-rgb: 56,128,255;--ion-color-primary-contrast: #ffffff;--ion-color-primary-contrast-rgb: 255,255,255;--ion-color-primary-shade: #3171e0;--ion-color-primary-tint: #4c8dff;--ion-color-secondary: #3dc2ff;--ion-color-secondary-rgb: 61,194,255;--ion-color-secondary-contrast: #000000;--ion-color-secondary-contrast-rgb: 0,0,0;--ion-color-secondary-shade: #36abe0;--ion-color-secondary-tint: #50c8ff;--ion-color-tertiary: #5260ff;--ion-color-tertiary-rgb: 82,96,255;--ion-color-tertiary-contrast: #ffffff;--ion-color-tertiary-contrast-rgb: 255,255,255;--ion-color-tertiary-shade: #4854e0;--ion-color-tertiary-tint: #6370ff;--ion-color-success: #2dd36f;--ion-color-success-rgb: 45,211,111;--ion-color-success-contrast: #000000;--ion-color-success-contrast-rgb: 0,0,0;--ion-color-success-shade: #28ba62;--ion-color-success-tint: #42d77d;--ion-color-warning: #ffc409;--ion-color-warning-rgb: 255,196,9;--ion-color-warning-contrast: #000000;--ion-color-warning-contrast-rgb: 0,0,0;--ion-color-warning-shade: #e0ac08;--ion-color-warning-tint: #ffca22;--ion-color-danger: #eb445a;--ion-color-danger-rgb: 235,68,90;--ion-color-danger-contrast: #000000;--ion-color-danger-contrast-rgb: 0,0,0;--ion-color-danger-shade: #cf3c4f;--ion-color-danger-tint: #ed576b;--ion-color-light: #f4f5f8;--ion-color-light-rgb: 244,245,248;--ion-color-light-contrast: #000000;--ion-color-light-contrast-rgb: 0,0,0;--ion-color-light-shade: #d7d8da;--ion-color-light-tint: #f5f6f9;--ion-color-medium: #92949c;--ion-color-medium-rgb: 146,148,156;--ion-color-medium-contrast: #000000;--ion-color-medium-contrast-rgb: 0,0,0;--ion-color-medium-shade: #808289;--ion-color-medium-tint: #9d9fa6;--ion-color-dark: #222428;--ion-color-dark-rgb: 34,36,40;--ion-color-dark-contrast: #ffffff;--ion-color-dark-contrast-rgb: 255,255,255;--ion-color-dark-shade: #1e2023;--ion-color-dark-tint: #383a3e}
`],encapsulation:2,changeDetection:0})}}return e})();import{CommonModule as ue}from"@angular/common";import"@angular/core";import{RouterModule as he}from"@angular/router";import{IonicModule as fe}from"@ionic/angular";import{CommonModule as me}from"@angular/common";import"@angular/core";import{IonicModule as pe}from"@ionic/angular";import*as u from"@angular/core";import*as Et from"@angular/router";import*as xt from"@ngx-translate/core";import*as j from"@ionic/angular";var z=(()=>{class e{constructor(t,i,o){this.router=t,this.cdr=i,this.translateSrv=o,this.showMenu=!0}changeLanguage(t){this.translateSrv.use(t),this.cdr.detectChanges()}openMenu(){this.router.navigate(["/main/","menu"])}static{this.\u0275fac=function(i){return new(i||e)(u.\u0275\u0275directiveInject(Et.Router),u.\u0275\u0275directiveInject(u.ChangeDetectorRef),u.\u0275\u0275directiveInject(xt.TranslateService))}}static{this.\u0275cmp=u.\u0275\u0275defineComponent({type:e,selectors:[["app-header"]],inputs:{showMenu:"showMenu"},standalone:!0,features:[u.\u0275\u0275StandaloneFeature],decls:4,vars:0,consts:[["color","primary"]],template:function(i,o){i&1&&(u.\u0275\u0275elementStart(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),u.\u0275\u0275text(3,"Lookttery"),u.\u0275\u0275elementEnd()()())},dependencies:[me,pe,j.IonHeader,j.IonTitle,j.IonToolbar],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--padding-top: calc(var(--ion-statusbar-padding, 0) + var(--ion-statusbar-padding, 0))}"],changeDetection:0})}}return e})();import"@angular/core";import{BehaviorSubject as de}from"rxjs";import*as K from"@angular/core";import*as Dt from"@ngx-translate/core";var Mt=(()=>{class e{constructor(t){this.translateService=t}transform(t){let i=new Date(t),o={weekday:"long",year:"numeric",month:"long",day:"numeric"},s=i.toLocaleDateString(this.translateService.currentLang,o),m=new de(s);return this.translateService.onLangChange.subscribe(()=>(s=i.toLocaleDateString(this.translateService.currentLang,o),m.next(s))),m}static{this.\u0275fac=function(i){return new(i||e)(K.\u0275\u0275directiveInject(Dt.TranslateService,16))}}static{this.\u0275pipe=K.\u0275\u0275definePipe({name:"date",type:e,pure:!0,standalone:!0})}}return e})();import{TranslateModule as ge}from"@ngx-translate/core";import*as r from"@angular/core";import*as v from"@ionic/angular";import*as Q from"@ngx-translate/core";import*as q from"@angular/common";var Se=(e,g)=>g.ticket._id;function ve(e,g){if(e&1){let t=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementStart(0,"section",2),r.\u0275\u0275element(1,"ion-img",3),r.\u0275\u0275elementStart(2,"section",4)(3,"ion-note",5),r.\u0275\u0275text(4),r.\u0275\u0275pipe(5,"async"),r.\u0275\u0275pipe(6,"date"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(7,"span",6),r.\u0275\u0275text(8),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(9,"span",7),r.\u0275\u0275text(10),r.\u0275\u0275pipe(11,"currency"),r.\u0275\u0275elementEnd()(),r.\u0275\u0275elementStart(12,"section",8)(13,"ion-icon",9),r.\u0275\u0275listener("click",function(){let s=r.\u0275\u0275restoreView(t).$implicit,m=r.\u0275\u0275nextContext();return r.\u0275\u0275resetView(m.deleteTicketById(s.ticket._id||""))}),r.\u0275\u0275elementEnd()()()}if(e&2){let t=g.$implicit,i=r.\u0275\u0275nextContext();r.\u0275\u0275advance(1),r.\u0275\u0275property("src",i.environment.web.host+"/assets/logos/games/"+t.ticket.code+".png"),r.\u0275\u0275advance(3),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(5,4,r.\u0275\u0275pipeBind1(6,6,t.ticket.date))),r.\u0275\u0275advance(4),r.\u0275\u0275textInterpolate(t.ticket.data.info.number),r.\u0275\u0275advance(2),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind2(11,8,t.prize.quantity/100,"EUR"))}}function Ce(e,g){e&1&&(r.\u0275\u0275elementStart(0,"section",10),r.\u0275\u0275element(1,"ion-icon",11),r.\u0275\u0275elementStart(2,"span",12),r.\u0275\u0275text(3),r.\u0275\u0275pipe(4,"translate"),r.\u0275\u0275elementEnd()()),e&2&&(r.\u0275\u0275advance(3),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(4,1,"TICKETS.EMPTY_TICKET_LIST")))}var wt=(()=>{class e{constructor(t,i,o,s,m){this.cdr=t,this.ticketSrv=i,this.gameSrv=o,this.loadingCtrl=s,this.translateSrv=m,this.tickets=[],this.environment=S}ngOnInit(){}ionViewDidEnter(){return l(this,null,function*(){yield this.getUserTickets(),this.sortTicketsByDate()})}sortTicketsByDate(){this.tickets.sort((t,i)=>{let o=new Date(t.ticket.date);return new Date(i.ticket.date).getTime()-o.getTime()}),this.cdr.detectChanges()}deleteTicketById(t){return l(this,null,function*(){(yield this.ticketSrv.deleteTicketById(t,!0))&&(yield this.getUserTickets())})}getUserTickets(){return l(this,null,function*(){yield this.showLoading();try{this.tickets=yield this.gameSrv.getAllTicketsPrizesByUser(),this.cdr.detectChanges(),console.log(this.tickets)}catch(t){console.log(t)}yield this.dismissLoading()})}showLoading(){return l(this,null,function*(){(yield this.loadingCtrl.create({message:this.translateSrv.instant("TICKETS.LOADING_TICKETS")})).present()})}dismissLoading(){return l(this,null,function*(){yield this.loadingCtrl.dismiss()})}static{this.\u0275fac=function(i){return new(i||e)(r.\u0275\u0275directiveInject(r.ChangeDetectorRef),r.\u0275\u0275directiveInject(P),r.\u0275\u0275directiveInject(U),r.\u0275\u0275directiveInject(v.LoadingController),r.\u0275\u0275directiveInject(Q.TranslateService))}}static{this.\u0275cmp=r.\u0275\u0275defineComponent({type:e,selectors:[["app-tickets"]],standalone:!0,features:[r.\u0275\u0275StandaloneFeature],decls:6,vars:1,consts:[["padding","","color","light"],[1,"ticket-list"],[1,"ticket-list-item"],["aria-hidden","true","slot","start","alt","",1,"ticket-list-item-img",3,"src"],[1,"ticket-list-item-data"],["color","medium",1,"ticket-list-item-data-date"],[1,"ticket-list-item-data-number"],[1,"ticket-list-item-data-prize"],[1,"ticket-list-item-actions"],["name","close-outline",1,"ticket-list-item-actions-delete",3,"click"],[1,"ticket-list-empty"],["name","scan-circle-outline",1,"ticket-list-empty-icon"],[1,"ticket-list-empty-message"],["class","ticket-list-item"]],template:function(i,o){i&1&&(r.\u0275\u0275element(0,"app-header"),r.\u0275\u0275elementStart(1,"ion-content",0)(2,"ion-list",1),r.\u0275\u0275repeaterCreate(3,ve,14,11,"section",13,Se,!1,Ce,5,3),r.\u0275\u0275elementEnd()()),i&2&&(r.\u0275\u0275advance(3),r.\u0275\u0275repeater(o.tickets))},dependencies:[ue,q.AsyncPipe,q.CurrencyPipe,he,fe,v.IonContent,v.IonIcon,v.IonImg,v.IonList,v.IonNote,z,Mt,ge,Q.TranslatePipe],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{height:100vh;width:100vw;padding-top:50px}[_nghost-%COMP%]   .ticket-list[_ngcontent-%COMP%]{margin-bottom:150px;background-color:transparent}[_nghost-%COMP%]   .ticket-list-item[_ngcontent-%COMP%]{background-color:#fff;display:flex;flex-direction:row;align-items:center;justify-content:flex-start;height:125px;margin:15px;border-radius:7px;box-shadow:#63636333 0 2px 8px}[_nghost-%COMP%]   .ticket-list-item-img[_ngcontent-%COMP%]{width:70px;height:70px;margin:0 15px}[_nghost-%COMP%]   .ticket-list-item-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}[_nghost-%COMP%]   .ticket-list-item-data-date[_ngcontent-%COMP%]{margin-bottom:15px;text-align:right}[_nghost-%COMP%]   .ticket-list-item-data-number[_ngcontent-%COMP%]{font-size:40px;font-weight:700;letter-spacing:17px;margin-bottom:12px}[_nghost-%COMP%]   .ticket-list-item-actions[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:row;justify-content:flex-end;margin:20px 15px 0}[_nghost-%COMP%]   .ticket-list-item-actions-delete[_ngcontent-%COMP%]{width:30px;height:30px}[_nghost-%COMP%]   .ticket-list-empty[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:300px}[_nghost-%COMP%]   .ticket-list-empty-icon[_ngcontent-%COMP%]{width:120px;height:120px;color:gray}[_nghost-%COMP%]   .ticket-list-empty-message[_ngcontent-%COMP%]{color:gray;font-size:20px;margin-top:20px}"],changeDetection:0})}}return e})();import{CommonModule as Ie}from"@angular/common";import"@angular/core";import{IonicModule as ye}from"@ionic/angular";import{QrCodeModule as _e}from"ng-qrcode";import{RouterModule as ke}from"@angular/router";import{TranslateModule as Te}from"@ngx-translate/core";import*as a from"@angular/core";import*as W from"@ngx-translate/core";import*as bt from"@angular/common";import*as f from"@ionic/angular";import*as Ot from"ng-qrcode";function Ee(e,g){if(e&1&&a.\u0275\u0275element(0,"qr-code",8),e&2){let t=a.\u0275\u0275nextContext();a.\u0275\u0275property("value",t.qrUuid)}}var Lt=(()=>{class e{constructor(t,i,o,s){this.cdr=t,this.uuidSrv=i,this.storageSrv=o,this.translateSrv=s,this.qrUuid="",this.languages=M,this.currentLanguage=this.storageSrv.getItem(p.LANGUAGE)||M.EN}ionViewDidEnter(){this.qrUuid=_.UUID_QR_CODE+this.uuidSrv.getUuid(),this.cdr.detectChanges()}changeLanguage(t){this.storageSrv.setItem(p.LANGUAGE,t),this.translateSrv.use(t),this.cdr.detectChanges()}static{this.\u0275fac=function(i){return new(i||e)(a.\u0275\u0275directiveInject(a.ChangeDetectorRef),a.\u0275\u0275directiveInject(T),a.\u0275\u0275directiveInject(C),a.\u0275\u0275directiveInject(W.TranslateService))}}static{this.\u0275cmp=a.\u0275\u0275defineComponent({type:e,selectors:[["app-menu"]],standalone:!0,features:[a.\u0275\u0275StandaloneFeature],decls:17,vars:12,consts:[[3,"showMenu"],["padding","","color","light"],[1,"menu-list"],[1,"menu-list-qr"],["size","300","errorCorrectionLevel","M",3,"value",4,"ngIf"],["interface","action-sheet",3,"value","ionChange"],["value","en"],["value","es"],["size","300","errorCorrectionLevel","M",3,"value"]],template:function(i,o){i&1&&(a.\u0275\u0275element(0,"app-header",0),a.\u0275\u0275elementStart(1,"ion-content",1)(2,"ion-list",2)(3,"section",3),a.\u0275\u0275template(4,Ee,1,1,"qr-code",4),a.\u0275\u0275elementEnd(),a.\u0275\u0275elementStart(5,"section")(6,"ion-item")(7,"ion-label"),a.\u0275\u0275text(8),a.\u0275\u0275pipe(9,"translate"),a.\u0275\u0275elementEnd(),a.\u0275\u0275elementStart(10,"ion-select",5),a.\u0275\u0275listener("ionChange",function(m){return o.changeLanguage(m.detail.value)}),a.\u0275\u0275elementStart(11,"ion-select-option",6),a.\u0275\u0275text(12),a.\u0275\u0275pipe(13,"translate"),a.\u0275\u0275elementEnd(),a.\u0275\u0275elementStart(14,"ion-select-option",7),a.\u0275\u0275text(15),a.\u0275\u0275pipe(16,"translate"),a.\u0275\u0275elementEnd()()()()()()),i&2&&(a.\u0275\u0275property("showMenu",!1),a.\u0275\u0275advance(4),a.\u0275\u0275property("ngIf",o.qrUuid),a.\u0275\u0275advance(4),a.\u0275\u0275textInterpolate(a.\u0275\u0275pipeBind1(9,6,"GLOBAL.LANGUAGE")),a.\u0275\u0275advance(2),a.\u0275\u0275propertyInterpolate("value",o.currentLanguage),a.\u0275\u0275advance(2),a.\u0275\u0275textInterpolate(a.\u0275\u0275pipeBind1(13,8,"GLOBAL.ENGLISH")),a.\u0275\u0275advance(3),a.\u0275\u0275textInterpolate(a.\u0275\u0275pipeBind1(16,10,"GLOBAL.SPANISH")))},dependencies:[Ie,bt.NgIf,ye,f.IonContent,f.IonItem,f.IonLabel,f.IonList,f.IonSelect,f.IonSelectOption,f.SelectValueAccessor,ke,_e,Ot.QrCodeComponent,z,Te,W.TranslatePipe],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{height:100vh;width:100vw;padding-top:50px}[_nghost-%COMP%]   .menu-list[_ngcontent-%COMP%]   .menu-list-qr[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;margin:10px 0 30px}"],changeDetection:0})}}return e})();var Fn=[{path:"",component:Tt,children:[{path:"",redirectTo:"main",pathMatch:"full"},{path:"main",component:It,children:[{path:"scan",component:St},{path:"tickets",component:wt},{path:"menu",component:Lt}]}]}];export{Fn as routes};
