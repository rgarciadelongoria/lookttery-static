import{c as l}from"./chunk-POLL2CVR.js";import{bootstrapApplication as ge}from"@angular/platform-browser";import{provideRouter as ue}from"@angular/router";import{CommonModule as _t}from"@angular/common";import"@angular/core";import{RouterModule as xt}from"@angular/router";import{IonicModule as Ot}from"@ionic/angular";var E=function(o){return o.SHELL_DEVICE_GET_ID="shellDeviceGetId",o.SHELL_SCANNER_RESPONSE="shellScannerResponse",o.SHELL_SCANNER_START="shellScannerStart",o.SHELL_SCANNER_STOP="shellScannerStop",o.SHELL_SCANNER_ERROR="shellScannerError",o.SHELL_DEVICE_GET_ID_RESPONSE="shellDeviceGetIdResponse",o}(E||{}),V=function(o){return o.SHELL_LOADING_REMOTE_OK="shellLoadingRemoteOk",o}(V||{});import*as p from"@angular/core";import*as et from"@angular/router";import"@angular/core";var h={api:{host:"https://api.lookttery.com/api"},web:{host:"https://lookttery.com"}};import{lastValueFrom as J}from"rxjs";var k=function(o){return o.TOKEN="token",o}(k||{}),T=function(o){return o.SYSTEM="[SYSTEM]",o}(T||{}),R=function(o){return o.UUID_EMAIL_DOMAIN="@uuid.app",o}(R||{});var w=function(o){return o.CANCEL="CANCEL",o.ACCEPT="ACCEPT",o}(w||{});import*as b from"@angular/core";import*as Z from"@ionic/angular";import*as X from"@ngx-translate/core";import{HttpHeaders as Mt}from"@angular/common/http";import"@angular/core";import{catchError as Dt,throwError as bt}from"rxjs";import*as D from"@angular/core";import*as Q from"@angular/common/http";import*as Y from"@angular/router";import"@angular/core";import*as q from"@angular/core";var M=(()=>{let i=class i{constructor(){}setItem(e,t){localStorage.setItem(e,t)}getItem(e){try{return JSON.parse(localStorage.getItem(e)||"")}catch{return localStorage.getItem(e)}}removeItem(e){localStorage.removeItem(e)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=q.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var W=function(o){return o.UNAUTHORIZED="Unauthorized",o}(W||{}),v=(()=>{let i=class i{constructor(e,t,r){this.http=e,this.router=t,this.storageSrv=r}get(e,t){return t=this.addTokenToHeaders(t),this.http.get(e,t)}post(e,t,r){return r=this.addPostHeaders(r),r=this.addTokenToHeaders(r),this.http.post(e,t,r).pipe(this.handleErrorAndRedirect())}delete(e,t){return t=this.addTokenToHeaders(t),this.http.delete(e,t)}addTokenToHeaders(e){let r=[["Authorization",`Bearer ${this.storageSrv.getItem(k.TOKEN)?.token}`]];return this.addHeaders(r,e)}addPostHeaders(e){let t=[["Content-Type","application/json"]];return this.addHeaders(t,e)}addHeaders(e,t){return e.forEach(r=>{t=t||{},t.headers=t.headers||{},t.headers instanceof Mt?t.headers=t.headers.append(r[0],r[1]):typeof t.headers=="object"&&(t.headers[r[0]]=r[1])}),t||{}}handleErrorAndRedirect(){return Dt((e,t)=>l(this,null,function*(){return e.status===401&&e.statusText===W.UNAUTHORIZED&&(this.storageSrv.removeItem(k.TOKEN),this.router.navigate(["/","main"])),bt(e)}))}};i.\u0275fac=function(t){return new(t||i)(D.\u0275\u0275inject(Q.HttpClient),D.\u0275\u0275inject(Y.Router),D.\u0275\u0275inject(M))},i.\u0275prov=D.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var _=(()=>{let i=class i{constructor(e,t,r){this.alertController=e,this.translateSrv=t,this.apiSrv=r,this.apiTicket=`${h.api.host}/ticket`}createNewTicket(e){return l(this,null,function*(){let t={data:{info:{code:e}}};try{let r=this.apiSrv.post(this.apiTicket,t);return yield J(r)}catch(r){throw r}})}deleteTicketById(e,t=!1){return l(this,null,function*(){let r=w.ACCEPT;if(t&&(r=yield this.presentAlertConfirmDeleteTicket()),r===w.ACCEPT)try{let a=yield this.apiSrv.delete(`${this.apiTicket}/${e}`);return yield J(a)}catch(a){throw a}})}presentAlertConfirmDeleteTicket(){return l(this,null,function*(){let e=yield this.alertController.create({header:this.translateSrv.instant("TICKETS.DELETE_TICKET"),subHeader:this.translateSrv.instant("GLOBAL.IRREVERSIBLE_ACTION"),message:this.translateSrv.instant("TICKETS.DELETE_TICKET_QUESTION"),buttons:[{text:this.translateSrv.instant("GLOBAL.CANCEL"),role:w.CANCEL,handler:()=>{}},{text:this.translateSrv.instant("GLOBAL.ACCEPT"),role:w.ACCEPT,handler:()=>{}}]});yield e.present();let{role:t}=yield e.onDidDismiss();return t})}};i.\u0275fac=function(t){return new(t||i)(b.\u0275\u0275inject(Z.AlertController),b.\u0275\u0275inject(X.TranslateService),b.\u0275\u0275inject(v))},i.\u0275prov=b.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();import*as it from"@ionic/angular";function Pt(o,i){o&1&&p.\u0275\u0275element(0,"ion-icon",3)}function Lt(o,i){o&1&&(p.\u0275\u0275elementStart(0,"article"),p.\u0275\u0275text(1,"Camera permission denied."),p.\u0275\u0275elementEnd())}var ot=(()=>{let i=class i{handleShellScannerResponse(e){return l(this,null,function*(){yield this.onScannerResponse(e.detail?.response||{})})}handleShellScannerError(e){return l(this,null,function*(){yield this.onScannerError(e.detail?.response||{})})}constructor(e,t){this.router=e,this.ticketSrv=t,this.responses=[],this.hasPermission=!0}ngOnInit(){}ionViewDidEnter(){this.startScan()}ionViewWillLeave(){this.stopScan()}startScan(){this.hasPermission=!0,window.dispatchEvent(new CustomEvent(E.SHELL_SCANNER_START))}stopScan(){window.dispatchEvent(new CustomEvent(E.SHELL_SCANNER_STOP))}onScannerResponse(e){return l(this,null,function*(){let t=yield this.ticketSrv.createNewTicket(e.content||"");this.exit()})}onScannerError(e){return l(this,null,function*(){console.log(e),this.hasPermission=!1})}exit(){this.router.navigate(["/main/","tickets"])}};i.\u0275fac=function(t){return new(t||i)(p.\u0275\u0275directiveInject(et.Router),p.\u0275\u0275directiveInject(_))},i.\u0275cmp=p.\u0275\u0275defineComponent({type:i,selectors:[["app-scan"]],hostBindings:function(t,r){t&1&&p.\u0275\u0275listener("shellScannerResponse",function(u){return r.handleShellScannerResponse(u)},!1,p.\u0275\u0275resolveWindow)("shellScannerError",function(u){return r.handleShellScannerError(u)},!1,p.\u0275\u0275resolveWindow)},standalone:!0,features:[p.\u0275\u0275StandaloneFeature],decls:4,vars:1,consts:[[1,"scan"],[1,"scan-screen"],["class","scan-screen-pointer","name","add-outline"],["name","add-outline",1,"scan-screen-pointer"]],template:function(t,r){t&1&&(p.\u0275\u0275elementStart(0,"section",0)(1,"section",1),p.\u0275\u0275template(2,Pt,1,0,"ion-icon",2)(3,Lt,2,0),p.\u0275\u0275elementEnd()()),t&2&&(p.\u0275\u0275advance(2),p.\u0275\u0275conditional(2,r.hasPermission?2:3))},dependencies:[_t,xt,Ot,it.IonIcon],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   .scan[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:flex-start;height:100vh;margin:0}[_nghost-%COMP%]   .scan-controls[_ngcontent-%COMP%]{width:100%;padding:20px}[_nghost-%COMP%]   .scan-controls[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:44px}[_nghost-%COMP%]   .scan-screen[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%}[_nghost-%COMP%]   .scan-screen-pointer[_ngcontent-%COMP%]{width:40px;color:#fff;height:40px}"],changeDetection:0});let o=i;return o})();import{CommonModule as Rt}from"@angular/common";import"@angular/core";import{RouterModule as At}from"@angular/router";import{IonicModule as Ut}from"@ionic/angular";import{TranslateModule as jt}from"@ngx-translate/core";import*as c from"@angular/core";import*as S from"@ionic/angular";import*as nt from"@ngx-translate/core";var Nt=["mainTabs"],rt=(()=>{let i=class i{constructor(){}ngOnInit(){}ngAfterViewInit(){setTimeout(()=>{this.mainTabs.select("scan")},500)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=c.\u0275\u0275defineComponent({type:i,selectors:[["app-main"]],viewQuery:function(t,r){if(t&1&&c.\u0275\u0275viewQuery(Nt,5),t&2){let a;c.\u0275\u0275queryRefresh(a=c.\u0275\u0275loadQuery())&&(r.mainTabs=a.first)}},standalone:!0,features:[c.\u0275\u0275StandaloneFeature],decls:13,vars:3,consts:[["mainTabs",""],["slot","bottom"],["tab","scan"],["name","scan-outline"],["tab","tickets"],["name","wallet-outline"]],template:function(t,r){t&1&&(c.\u0275\u0275element(0,"ion-router-outlet"),c.\u0275\u0275elementStart(1,"ion-tabs",null,0)(3,"ion-tab-bar",1)(4,"ion-tab-button",2),c.\u0275\u0275element(5,"ion-icon",3),c.\u0275\u0275elementStart(6,"span"),c.\u0275\u0275text(7),c.\u0275\u0275pipe(8,"translate"),c.\u0275\u0275elementEnd()(),c.\u0275\u0275elementStart(9,"ion-tab-button",4),c.\u0275\u0275element(10,"ion-icon",5),c.\u0275\u0275elementStart(11,"span"),c.\u0275\u0275text(12,"Tickets"),c.\u0275\u0275elementEnd()()()()),t&2&&(c.\u0275\u0275advance(7),c.\u0275\u0275textInterpolate(c.\u0275\u0275pipeBind1(8,1,"MAIN.SCAN_NOW")))},dependencies:[Rt,At,Ut,S.IonIcon,S.IonTabBar,S.IonTabButton,S.IonTabs,S.IonRouterOutlet,jt,nt.TranslatePipe],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   ion-tab-bar[_ngcontent-%COMP%]{padding-bottom:var(--ion-statusbar-padding, 0)}"],changeDetection:0});let o=i;return o})();import{CommonModule as Vt}from"@angular/common";import{HttpClient as Kt,HttpClientModule as Gt}from"@angular/common/http";import"@angular/core";import{NavigationEnd as zt,RouterModule as qt}from"@angular/router";import{filter as Qt}from"rxjs";import{IonicModule as Yt}from"@ionic/angular";import"@angular/core";import{lastValueFrom as at}from"rxjs";import*as L from"@angular/core";import"@angular/core";import{lastValueFrom as G}from"rxjs";import*as P from"@angular/core";var Ht=1e3*60*60*1.5,y=(()=>{let i=class i{constructor(e,t){this.apiSrv=e,this.storageSrv=t,this.apiUser=`${h.api.host}/user`}createUserByUuid(e){return l(this,null,function*(){let t={email:`${e}${R.UUID_EMAIL_DOMAIN}`,password:e,name:e};try{let r=this.apiSrv.post(this.apiUser,t);return yield G(r)}catch(r){throw r}})}loginByUuid(e){return l(this,null,function*(){return yield this.login(`${e}${R.UUID_EMAIL_DOMAIN}`,e)})}login(e,t){return l(this,null,function*(){let r={email:e,password:t};try{let a=this.apiSrv.post(`${this.apiUser}/login`,r),u=yield G(a);if(u.token){let wt={token:u.token,date:Date.now()};this.storageSrv.setItem(k.TOKEN,JSON.stringify(wt)),console.info(T.SYSTEM,`${u.token}`)}return u}catch(a){throw a}})}checkTokenExpiration(e){return l(this,null,function*(){let r=this.storageSrv.getItem(k.TOKEN)?.date||0;Date.now()-r>Ht&&(yield this.loginByUuid(e))})}getAllTicketsByUser(){return l(this,null,function*(){try{let e=this.apiSrv.get(`${this.apiUser}/ticket/all?limit=100&offset=0`);return yield G(e)}catch{return[]}})}};i.\u0275fac=function(t){return new(t||i)(P.\u0275\u0275inject(v),P.\u0275\u0275inject(M))},i.\u0275prov=P.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var x=(()=>{let i=class i{constructor(e,t){this.apiSrv=e,this.userSrv=t,this.uuid="",this.apiUuid=`${h.api.host}/uuid`,window.addEventListener(E.SHELL_DEVICE_GET_ID_RESPONSE,r=>l(this,null,function*(){yield this.onDeviceIdResponse(r.detail?.response||{})}))}init(){this.requestDeviceId()}getUuid(){return this.uuid}requestDeviceId(){window.dispatchEvent(new CustomEvent(E.SHELL_DEVICE_GET_ID))}onDeviceIdResponse(e){return l(this,null,function*(){this.uuid=e||"",(yield this.getUuidData())?(yield this.userSrv.loginByUuid(this.uuid),console.info(T.SYSTEM,`UUID ${this.uuid} was registered.`)):yield this.registerUuid()})}getUuidData(){return l(this,null,function*(){try{let e=this.apiSrv.get(`${this.apiUuid}/${this.uuid}`);return yield at(e)}catch{return null}})}registerUuid(){return l(this,null,function*(){let e=yield this.userSrv.createUserByUuid(this.uuid);if((yield this.userSrv.loginByUuid(this.uuid)).token){let r={uuid:this.uuid,user:e._id};try{let a=this.apiSrv.post(this.apiUuid,r),u=yield at(a);this.uuid=u.uuid,console.info(T.SYSTEM,`UUID ${this.uuid} has been registered.`)}catch(a){console.error(a)}}})}};i.\u0275fac=function(t){return new(t||i)(L.\u0275\u0275inject(v),L.\u0275\u0275inject(y))},i.\u0275prov=L.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();import{TranslateLoader as Wt,TranslateModule as Jt}from"@ngx-translate/core";import"@angular/core";import{catchError as Bt}from"rxjs/operators";import*as U from"@angular/core";import*as ct from"@angular/common/http";var mt=(()=>{let i=class i{constructor(e){this.httpClient=e}getTranslation(e){let t=h.web.host+`/assets/i18n/${e}.json`;return this.httpClient.get(t).pipe(Bt(r=>(console.log("Error loading translation file",r),this.httpClient.get(h.web.host+"/assets/i18n/es.json"))))}};i.\u0275fac=function(t){return new(t||i)(U.\u0275\u0275inject(ct.HttpClient))},i.\u0275prov=U.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac});let o=i;return o})();import"@angular/core";import{lastValueFrom as $t}from"rxjs";import*as j from"@angular/core";var N=(()=>{let i=class i{constructor(e){this.apiSrv=e,this.apiGame=`${h.api.host}/game`}getAllTicketsPrizesByUser(){return l(this,null,function*(){try{let e=this.apiSrv.get(`${this.apiGame}/ticket/all?limit=100&offset=0`);return yield $t(e)}catch{return[]}})}};i.\u0275fac=function(t){return new(t||i)(j.\u0275\u0275inject(v))},i.\u0275prov=j.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();import*as f from"@angular/core";import*as lt from"@ngx-translate/core";import*as H from"@angular/router";var pt=(()=>{let i=class i{constructor(e,t,r,a,u){this.translateSrv=e,this.uuidSrv=t,this.userSrv=r,this.storageSrv=a,this.router=u,this.translateSrv.setDefaultLang("en"),this.translateSrv.use("en")}ngOnInit(){this.setNoErrorLoadingRemote(),this.importStyles(),this.importScripts(),this.uuidSrv.init(),this.router.events.pipe(Qt(e=>e instanceof zt)).subscribe(e=>{let t=this.uuidSrv.getUuid();t?this.userSrv.checkTokenExpiration(t):this.uuidSrv.init()})}setNoErrorLoadingRemote(){this.storageSrv.setItem(V.SHELL_LOADING_REMOTE_OK,!0)}importScripts(){let e=["https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.esm.js","https://cdn.jsdelivr.net/npm/ionicons/dist/ionicons/ionicons.esm.js"],t=document.head;e.forEach(r=>{let a=document.createElement("script");a.type="module",a.src=r,a.async=!1,document.head.appendChild(a),t.insertBefore(a,t.firstElementChild)})}importStyles(){let e=["https://cdn.jsdelivr.net/npm/@ionic/core/css/ionic.bundle.css"],t=document.head;e.forEach(r=>{let a=document.createElement("link");a.rel="stylesheet",a.href=r,t.insertBefore(a,t.firstElementChild)})}};i.\u0275fac=function(t){return new(t||i)(f.\u0275\u0275directiveInject(lt.TranslateService),f.\u0275\u0275directiveInject(x),f.\u0275\u0275directiveInject(y),f.\u0275\u0275directiveInject(M),f.\u0275\u0275directiveInject(H.Router))},i.\u0275cmp=f.\u0275\u0275defineComponent({type:i,selectors:[["app-remote-app"]],standalone:!0,features:[f.\u0275\u0275ProvidersFeature([v,x,y,_,N,Jt.forRoot({loader:{provide:Wt,useClass:mt,deps:[Kt]}}).providers]),f.\u0275\u0275StandaloneFeature],decls:1,vars:0,template:function(t,r){t&1&&f.\u0275\u0275element(0,"router-outlet")},dependencies:[Vt,qt,H.RouterOutlet,Yt,Gt],styles:[`:host{display:block}body{--ion-color-primary: #3880ff;--ion-color-primary-rgb: 56,128,255;--ion-color-primary-contrast: #000000;--ion-color-primary-contrast-rgb: 0,0,0;--ion-color-primary-shade: #3171e0;--ion-color-primary-tint: #4c8dff;--ion-color-secondary: #3dc2ff;--ion-color-secondary-rgb: 61,194,255;--ion-color-secondary-contrast: #000000;--ion-color-secondary-contrast-rgb: 0,0,0;--ion-color-secondary-shade: #36abe0;--ion-color-secondary-tint: #50c8ff;--ion-color-tertiary: #5260ff;--ion-color-tertiary-rgb: 82,96,255;--ion-color-tertiary-contrast: #ffffff;--ion-color-tertiary-contrast-rgb: 255,255,255;--ion-color-tertiary-shade: #4854e0;--ion-color-tertiary-tint: #6370ff;--ion-color-success: #2dd36f;--ion-color-success-rgb: 45,211,111;--ion-color-success-contrast: #000000;--ion-color-success-contrast-rgb: 0,0,0;--ion-color-success-shade: #28ba62;--ion-color-success-tint: #42d77d;--ion-color-warning: #ffc409;--ion-color-warning-rgb: 255,196,9;--ion-color-warning-contrast: #000000;--ion-color-warning-contrast-rgb: 0,0,0;--ion-color-warning-shade: #e0ac08;--ion-color-warning-tint: #ffca22;--ion-color-danger: #eb445a;--ion-color-danger-rgb: 235,68,90;--ion-color-danger-contrast: #000000;--ion-color-danger-contrast-rgb: 0,0,0;--ion-color-danger-shade: #cf3c4f;--ion-color-danger-tint: #ed576b;--ion-color-light: #f4f5f8;--ion-color-light-rgb: 244,245,248;--ion-color-light-contrast: #000000;--ion-color-light-contrast-rgb: 0,0,0;--ion-color-light-shade: #d7d8da;--ion-color-light-tint: #f5f6f9;--ion-color-medium: #92949c;--ion-color-medium-rgb: 146,148,156;--ion-color-medium-contrast: #000000;--ion-color-medium-contrast-rgb: 0,0,0;--ion-color-medium-shade: #808289;--ion-color-medium-tint: #9d9fa6;--ion-color-dark: #222428;--ion-color-dark-rgb: 34,36,40;--ion-color-dark-contrast: #ffffff;--ion-color-dark-contrast-rgb: 255,255,255;--ion-color-dark-shade: #1e2023;--ion-color-dark-tint: #383a3e}
`],encapsulation:2,changeDetection:0});let o=i;return o})();import{CommonModule as ie}from"@angular/common";import"@angular/core";import{RouterModule as oe}from"@angular/router";import{IonicModule as ne}from"@ionic/angular";import{CommonModule as Zt}from"@angular/common";import"@angular/core";import{IonicModule as Xt}from"@ionic/angular";import*as s from"@angular/core";import*as dt from"@angular/router";import*as ut from"@ngx-translate/core";import*as ft from"@angular/common";import*as C from"@ionic/angular";function te(o,i){if(o&1){let g=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"ion-button",3),s.\u0275\u0275listener("click",function(){s.\u0275\u0275restoreView(g);let t=s.\u0275\u0275nextContext();return s.\u0275\u0275resetView(t.openMenu())}),s.\u0275\u0275text(1,"MENU"),s.\u0275\u0275elementEnd()}}var B=(()=>{let i=class i{constructor(e,t,r){this.router=e,this.cdr=t,this.translateSrv=r,this.showMenu=!0}changeLanguage(e){this.translateSrv.use(e),this.cdr.detectChanges()}openMenu(){this.router.navigate(["/main/","menu"])}};i.\u0275fac=function(t){return new(t||i)(s.\u0275\u0275directiveInject(dt.Router),s.\u0275\u0275directiveInject(s.ChangeDetectorRef),s.\u0275\u0275directiveInject(ut.TranslateService))},i.\u0275cmp=s.\u0275\u0275defineComponent({type:i,selectors:[["app-header"]],inputs:{showMenu:"showMenu"},standalone:!0,features:[s.\u0275\u0275StandaloneFeature],decls:6,vars:1,consts:[["color","primary"],["slot","end"],[3,"click",4,"ngIf"],[3,"click"]],template:function(t,r){t&1&&(s.\u0275\u0275elementStart(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),s.\u0275\u0275text(3,"Lookttery"),s.\u0275\u0275elementEnd(),s.\u0275\u0275elementStart(4,"ion-buttons",1),s.\u0275\u0275template(5,te,2,0,"ion-button",2),s.\u0275\u0275elementEnd()()()),t&2&&(s.\u0275\u0275advance(5),s.\u0275\u0275property("ngIf",r.showMenu))},dependencies:[Zt,ft.NgIf,Xt,C.IonButton,C.IonButtons,C.IonHeader,C.IonTitle,C.IonToolbar],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--padding-top: calc(var(--ion-statusbar-padding, 0) + var(--ion-statusbar-padding, 0))}"],changeDetection:0});let o=i;return o})();import"@angular/core";import{BehaviorSubject as ee}from"rxjs";import*as $ from"@angular/core";import*as ht from"@ngx-translate/core";var gt=(()=>{let i=class i{constructor(e){this.translateService=e}transform(e){let t=new Date(e),r={weekday:"long",year:"numeric",month:"long",day:"numeric"},a=t.toLocaleDateString(this.translateService.currentLang,r),u=new ee(a);return this.translateService.onLangChange.subscribe(()=>(a=t.toLocaleDateString(this.translateService.currentLang,r),u.next(a))),u}};i.\u0275fac=function(t){return new(t||i)($.\u0275\u0275directiveInject(ht.TranslateService,16))},i.\u0275pipe=$.\u0275\u0275definePipe({name:"date",type:i,pure:!0,standalone:!0});let o=i;return o})();import*as n from"@angular/core";import*as F from"@angular/common";import*as d from"@ionic/angular";var re=(o,i)=>i.ticket._id;function ae(o,i){if(o&1){let g=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"ion-item-sliding")(1,"ion-item",2)(2,"ion-label",3)(3,"ion-note",4),n.\u0275\u0275text(4),n.\u0275\u0275pipe(5,"async"),n.\u0275\u0275pipe(6,"date"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(7,"section",5),n.\u0275\u0275element(8,"ion-img",6),n.\u0275\u0275elementStart(9,"strong",7),n.\u0275\u0275text(10),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(11,"span",8),n.\u0275\u0275text(12),n.\u0275\u0275pipe(13,"currency"),n.\u0275\u0275elementEnd()()()(),n.\u0275\u0275elementStart(14,"ion-item-options",9)(15,"ion-item-option",10),n.\u0275\u0275listener("click",function(){let r=n.\u0275\u0275restoreView(g).$implicit,a=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(a.deleteTicketById(r.ticket._id||""))}),n.\u0275\u0275element(16,"ion-icon",11),n.\u0275\u0275elementEnd()()()}if(o&2){let g=i.$implicit,e=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275property("button",!0),n.\u0275\u0275advance(3),n.\u0275\u0275textInterpolate(n.\u0275\u0275pipeBind1(5,5,n.\u0275\u0275pipeBind1(6,7,g.ticket.date))),n.\u0275\u0275advance(4),n.\u0275\u0275property("src",e.environment.web.host+"/assets/logos/games/"+g.ticket.code+".png"),n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate(g.ticket.data.info.number),n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate(n.\u0275\u0275pipeBind2(13,9,g.prize.quantity/100,"EUR"))}}function se(o,i){o&1&&(n.\u0275\u0275elementStart(0,"p"),n.\u0275\u0275text(1,"Empty list of tickets"),n.\u0275\u0275elementEnd())}var vt=(()=>{let i=class i{constructor(e,t,r,a){this.cdr=e,this.userSrv=t,this.ticketSrv=r,this.gameSrv=a,this.tickets=[],this.environment=h}ngOnInit(){}ionViewDidEnter(){return l(this,null,function*(){yield this.getUserTickets(),this.sortTicketsByDate()})}sortTicketsByDate(){this.tickets.sort((e,t)=>{let r=new Date(e.ticket.date);return new Date(t.ticket.date).getTime()-r.getTime()}),this.cdr.detectChanges()}deleteTicketById(e){return l(this,null,function*(){yield this.ticketSrv.deleteTicketById(e,!0),yield this.getUserTickets()})}getUserTickets(){return l(this,null,function*(){this.tickets=yield this.gameSrv.getAllTicketsPrizesByUser(),this.cdr.detectChanges(),console.log(this.tickets)})}};i.\u0275fac=function(t){return new(t||i)(n.\u0275\u0275directiveInject(n.ChangeDetectorRef),n.\u0275\u0275directiveInject(y),n.\u0275\u0275directiveInject(_),n.\u0275\u0275directiveInject(N))},i.\u0275cmp=n.\u0275\u0275defineComponent({type:i,selectors:[["app-tickets"]],standalone:!0,features:[n.\u0275\u0275StandaloneFeature],decls:6,vars:1,consts:[["padding","","color","light"],[1,"ticket-list"],[1,"ticket-item",3,"button"],[1,"ticket-item-text"],["color","medium"],[1,"game-item-data"],["aria-hidden","true","slot","start","alt","",1,"game-item-img",3,"src"],[1,"game-item-data-number"],[1,"game-item-prize"],["slot","end"],["color","danger","expandable","true",3,"click"],["slot","icon-only","name","trash"]],template:function(t,r){t&1&&(n.\u0275\u0275element(0,"app-header"),n.\u0275\u0275elementStart(1,"ion-content",0)(2,"ion-list",1),n.\u0275\u0275repeaterCreate(3,ae,17,12,"ion-item-sliding",null,re,!1,se,2,0),n.\u0275\u0275elementEnd()()),t&2&&(n.\u0275\u0275advance(3),n.\u0275\u0275repeater(r.tickets))},dependencies:[ie,F.AsyncPipe,F.CurrencyPipe,oe,ne,d.IonContent,d.IonIcon,d.IonImg,d.IonItem,d.IonItemOption,d.IonItemOptions,d.IonItemSliding,d.IonLabel,d.IonList,d.IonNote,B,gt],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{height:100vh;width:100vw;padding-top:50px}[_nghost-%COMP%]   .ticket-list[_ngcontent-%COMP%]{margin-bottom:150px}[_nghost-%COMP%]   .ticket-list[_ngcontent-%COMP%]   .ticket-item[_ngcontent-%COMP%]   .ticket-item-text[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .ticket-list[_ngcontent-%COMP%]   .ticket-item[_ngcontent-%COMP%]   .ticket-item-text[_ngcontent-%COMP%]   .game-item-img[_ngcontent-%COMP%]{width:40px;height:40px}[_nghost-%COMP%]   .ticket-list[_ngcontent-%COMP%]   .ticket-item[_ngcontent-%COMP%]   .ticket-item-text[_ngcontent-%COMP%]   .game-item-data[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:calc(100% - 45px);align-items:center;margin-top:12px}[_nghost-%COMP%]   .ticket-list[_ngcontent-%COMP%]   .ticket-item[_ngcontent-%COMP%]   .ticket-item-text[_ngcontent-%COMP%]   .game-item-data[_ngcontent-%COMP%]   .game-item-data-number[_ngcontent-%COMP%]{letter-spacing:15px;font-size:30px;display:block;width:100%;padding-left:12px}"],changeDetection:0});let o=i;return o})();import{CommonModule as ce}from"@angular/common";import"@angular/core";import{IonicModule as me}from"@ionic/angular";import{QrCodeModule as le}from"ng-qrcode";import{RouterModule as pe}from"@angular/router";import*as m from"@angular/core";import*as St from"@angular/common";import*as I from"@ionic/angular";import*as Ct from"ng-qrcode";function de(o,i){if(o&1&&m.\u0275\u0275element(0,"qr-code",4),o&2){let g=m.\u0275\u0275nextContext();m.\u0275\u0275property("value",g.qrUuid)}}var yt=(()=>{let i=class i{constructor(e,t){this.cdr=e,this.uuidSrv=t,this.qrUuid="aaa"}ngOnInit(){this.qrUuid=this.uuidSrv.getUuid(),this.cdr.detectChanges()}};i.\u0275fac=function(t){return new(t||i)(m.\u0275\u0275directiveInject(m.ChangeDetectorRef),m.\u0275\u0275directiveInject(x))},i.\u0275cmp=m.\u0275\u0275defineComponent({type:i,selectors:[["app-menu"]],standalone:!0,features:[m.\u0275\u0275StandaloneFeature],decls:7,vars:3,consts:[[3,"showMenu"],["padding","","color","light"],[1,"menu-list"],["size","300","errorCorrectionLevel","M",3,"value",4,"ngIf"],["size","300","errorCorrectionLevel","M",3,"value"]],template:function(t,r){t&1&&(m.\u0275\u0275element(0,"app-header",0),m.\u0275\u0275elementStart(1,"ion-content",1)(2,"ion-list",2)(3,"ion-item"),m.\u0275\u0275template(4,de,1,1,"qr-code",3),m.\u0275\u0275elementStart(5,"ion-label"),m.\u0275\u0275text(6),m.\u0275\u0275elementEnd()()()()),t&2&&(m.\u0275\u0275property("showMenu",!1),m.\u0275\u0275advance(4),m.\u0275\u0275property("ngIf",r.qrUuid),m.\u0275\u0275advance(2),m.\u0275\u0275textInterpolate(r.qrUuid))},dependencies:[ce,St.NgIf,me,I.IonContent,I.IonItem,I.IonLabel,I.IonList,pe,le,Ct.QrCodeComponent,B],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{height:100vh;width:100vw;padding-top:50px}"],changeDetection:0});let o=i;return o})();var It=[{path:"",component:pt,children:[{path:"",redirectTo:"main",pathMatch:"full"},{path:"main",component:rt,children:[{path:"scan",component:ot},{path:"tickets",component:vt},{path:"menu",component:yt}]}]}];var Et={providers:[ue(It)]};import"@angular/core";import{CommonModule as fe}from"@angular/common";import{RouterModule as he}from"@angular/router";import*as O from"@angular/core";import*as kt from"@angular/router";var Tt=(()=>{let i=class i{constructor(){this.title="lookttery-app"}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=O.\u0275\u0275defineComponent({type:i,selectors:[["app-root"]],standalone:!0,features:[O.\u0275\u0275StandaloneFeature],decls:1,vars:0,template:function(t,r){t&1&&O.\u0275\u0275element(0,"router-outlet")},dependencies:[fe,he,kt.RouterOutlet]});let o=i;return o})();ge(Tt,Et).catch(o=>console.error(o));
