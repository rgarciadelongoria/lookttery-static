var u=(e,h,t)=>new Promise((i,n)=>{var p=T=>{try{D(t.next(T))}catch($){n($)}},g=T=>{try{D(t.throw(T))}catch($){n($)}},D=T=>T.done?i(T.value):Promise.resolve(T.value).then(p,g);D((t=t.apply(e,h)).next())});import{CommonModule as le}from"@angular/common";import"@angular/core";import{RouterModule as me}from"@angular/router";import{IonicModule as de}from"@ionic/angular";var dt=function(e){return e.SHELL_VERSION="shellVersion",e}(dt||{}),L=function(e){return e.SHELL_DEVICE_GET_ID="shellDeviceGetId",e.SHELL_SCANNER_RESPONSE="shellScannerResponse",e.SHELL_SCANNER_START="shellScannerStart",e.SHELL_SCANNER_STOP="shellScannerStop",e.SHELL_SCANNER_ERROR="shellScannerError",e.SHELL_DEVICE_GET_ID_RESPONSE="shellDeviceGetIdResponse",e}(L||{}),pt=function(e){return e.SHELL_LOADING_REMOTE_OK="shellLoadingRemoteOk",e}(pt||{});var C=function(e){return e.TOKEN="token",e.APP_UUID="appUuid",e.LANGUAGE="language",e}(C||{}),U=function(e){return e.EN="en",e.ES="es",e}(U||{}),G=function(e){return e.SYSTEM="[SYSTEM]",e}(G||{}),b=function(e){return e.UUID_EMAIL_DOMAIN="@uuid.app",e.UUID_QR_CODE="app-uuid-code:",e.GAME_CODES="GameCodes",e}(b||{}),S=function(e){return e.LOTERIA_NACIONAL="ln",e}(S||{}),j=function(e){return e.CANCEL="CANCEL",e.ACCEPT="ACCEPT",e}(j||{});import{TranslateModule as pe}from"@ngx-translate/core";import{CommonModule as Xt}from"@angular/common";import{EventEmitter as te}from"@angular/core";var f={api:{host:"https://api.lookttery.com/api"},web:{host:"https://lookttery.com"}};import"@angular/core";import{BehaviorSubject as Yt}from"rxjs";import*as q from"@angular/core";import*as St from"@ngx-translate/core";var Q=(()=>{class e{constructor(t){this.translateService=t}transform(t){let i=new Date(t),n={weekday:"long",year:"numeric",month:"long",day:"numeric"},p=i.toLocaleDateString(this.translateService.currentLang,n),g=new Yt(p);return this.translateService.onLangChange.subscribe(()=>(p=i.toLocaleDateString(this.translateService.currentLang,n),g.next(p))),g}static{this.\u0275fac=function(i){return new(i||e)(q.\u0275\u0275directiveInject(St.TranslateService,16))}}static{this.\u0275pipe=q.\u0275\u0275definePipe({name:"date",type:e,pure:!0,standalone:!0})}}return e})();import{IonicModule as ee}from"@ionic/angular";import*as r from"@angular/core";import"@angular/core";import{lastValueFrom as Tt}from"rxjs";import*as R from"@angular/core";import*as bt from"@ionic/angular";import*as Mt from"@ngx-translate/core";import{HttpHeaders as Jt}from"@angular/common/http";import"@angular/core";import{catchError as Zt}from"rxjs";import*as N from"@angular/core";import*as xt from"@angular/common/http";import*as It from"@angular/router";import"@angular/core";import*as yt from"@angular/core";var x=(()=>{class e{constructor(){}setItem(t,i){localStorage.setItem(t,i)}getItem(t){try{return JSON.parse(localStorage.getItem(t)||"")}catch{return localStorage.getItem(t)}}removeItem(t){localStorage.removeItem(t)}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=yt.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var kt=function(e){return e.UNAUTHORIZED="Unauthorized",e}(kt||{}),I=(()=>{class e{constructor(t,i,n){this.http=t,this.router=i,this.storageSrv=n}get(t,i){return i=this.addTokenToHeaders(i),this.http.get(t,i)}post(t,i,n){return n=this.addPostHeaders(n),n=this.addTokenToHeaders(n),this.http.post(t,i,n).pipe(this.handleErrorAndRedirect())}delete(t,i){return i=this.addTokenToHeaders(i),this.http.delete(t,i)}addTokenToHeaders(t){let n=[["Authorization",`Bearer ${this.storageSrv.getItem(C.TOKEN)?.token}`]];return this.addHeaders(n,t)}addPostHeaders(t){let i=[["Content-Type","application/json"]];return this.addHeaders(i,t)}addHeaders(t,i){return t.forEach(n=>{i=i||{},i.headers=i.headers||{},i.headers instanceof Jt?i.headers=i.headers.append(n[0],n[1]):typeof i.headers=="object"&&(i.headers[n[0]]=n[1])}),i||{}}handleErrorAndRedirect(){return Zt((t,i)=>u(this,null,function*(){throw t.status===401&&t.statusText===kt.UNAUTHORIZED&&(this.storageSrv.removeItem(C.TOKEN),this.router.navigate(["/","main"])),t}))}static{this.\u0275fac=function(i){return new(i||e)(N.\u0275\u0275inject(xt.HttpClient),N.\u0275\u0275inject(It.Router),N.\u0275\u0275inject(x))}}static{this.\u0275prov=N.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var M=(()=>{class e{constructor(t,i,n){this.alertController=t,this.translateSrv=i,this.apiSrv=n,this.apiTicket=`${f.api.host}/ticket`}createNewTicket(t){return u(this,null,function*(){let i={data:{info:{code:t}}};try{let n=yield this.apiSrv.post(this.apiTicket,i);return yield Tt(n)}catch(n){throw n}})}deleteTicketById(t){return u(this,null,function*(){try{let i=yield this.apiSrv.delete(`${this.apiTicket}/${t}`);return yield Tt(i)}catch(i){throw i}})}presentAlertConfirmDeleteTicket(){return u(this,null,function*(){let t=yield this.alertController.create({header:this.translateSrv.instant("TICKETS.DELETE_TICKET"),subHeader:this.translateSrv.instant("GLOBAL.IRREVERSIBLE_ACTION"),message:this.translateSrv.instant("TICKETS.DELETE_TICKET_QUESTION"),buttons:[{text:this.translateSrv.instant("GLOBAL.CANCEL"),role:j.CANCEL,handler:()=>{}},{text:this.translateSrv.instant("GLOBAL.ACCEPT"),role:j.ACCEPT,handler:()=>{}}]});yield t.present();let{role:i}=yield t.onDidDismiss();return i})}static{this.\u0275fac=function(i){return new(i||e)(R.\u0275\u0275inject(bt.AlertController),R.\u0275\u0275inject(Mt.TranslateService),R.\u0275\u0275inject(I))}}static{this.\u0275prov=R.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();import*as Y from"@angular/common";import*as J from"@ionic/angular";function ie(e,h){e&1&&(r.\u0275\u0275elementStart(0,"section",1),r.\u0275\u0275element(1,"ion-skeleton-text",2),r.\u0275\u0275elementStart(2,"section",3),r.\u0275\u0275element(3,"ion-skeleton-text",4)(4,"ion-skeleton-text",5)(5,"ion-skeleton-text",6),r.\u0275\u0275elementEnd()()),e&2&&(r.\u0275\u0275advance(1),r.\u0275\u0275property("animated",!0),r.\u0275\u0275advance(2),r.\u0275\u0275property("animated",!0),r.\u0275\u0275advance(1),r.\u0275\u0275property("animated",!0),r.\u0275\u0275advance(1),r.\u0275\u0275property("animated",!0))}function ne(e,h){if(e&1){let t=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementStart(0,"section",12)(1,"ion-icon",13),r.\u0275\u0275listener("click",function(){r.\u0275\u0275restoreView(t);let n=r.\u0275\u0275nextContext(2);return r.\u0275\u0275resetView(n.deleteTicketById(n.data.ticket._id||""))}),r.\u0275\u0275elementEnd()()}}function oe(e,h){if(e&1&&(r.\u0275\u0275elementStart(0,"section",1),r.\u0275\u0275element(1,"img",7),r.\u0275\u0275elementStart(2,"section",3)(3,"span",8),r.\u0275\u0275text(4),r.\u0275\u0275pipe(5,"async"),r.\u0275\u0275pipe(6,"date"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(7,"span",9),r.\u0275\u0275text(8),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(9,"span",10),r.\u0275\u0275text(10),r.\u0275\u0275pipe(11,"currency"),r.\u0275\u0275elementEnd()(),r.\u0275\u0275template(12,ne,2,0,"section",11),r.\u0275\u0275elementEnd()),e&2){let t=r.\u0275\u0275nextContext();r.\u0275\u0275advance(1),r.\u0275\u0275property("src",t.environment.web.host+"/assets/logos/games/"+t.data.ticket.code+".png",r.\u0275\u0275sanitizeUrl),r.\u0275\u0275advance(3),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(5,5,r.\u0275\u0275pipeBind1(6,7,t.data.ticket.date))),r.\u0275\u0275advance(4),r.\u0275\u0275textInterpolate(t.data.ticket.data.info.number),r.\u0275\u0275advance(2),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind2(11,9,t.data.prize.quantity/100,"EUR")),r.\u0275\u0275advance(2),r.\u0275\u0275conditional(12,t.showActions?12:-1)}}function re(e,h){e&1&&(r.\u0275\u0275elementStart(0,"p"),r.\u0275\u0275text(1,"Game not available"),r.\u0275\u0275elementEnd())}var Z=(()=>{class e{constructor(t){this.ticketSrv=t,this.skeleton=!1,this.showActions=!0,this.deleteTicketEvent=new te,this.environment=f,this.gameCodes=S}deleteTicketById(t){return u(this,null,function*(){if((yield this.ticketSrv.presentAlertConfirmDeleteTicket())===j.ACCEPT){this.skeleton=!0;let n=yield this.ticketSrv.deleteTicketById(t);n&&this.deleteTicketEvent.emit(n)}})}static{this.\u0275fac=function(i){return new(i||e)(r.\u0275\u0275directiveInject(M))}}static{this.\u0275cmp=r.\u0275\u0275defineComponent({type:e,selectors:[["app-ticket"]],inputs:{data:"data",skeleton:"skeleton",showActions:"showActions"},outputs:{deleteTicketEvent:"deleteTicketEvent"},standalone:!0,features:[r.\u0275\u0275StandaloneFeature],decls:3,vars:1,consts:[["class","ticket"],[1,"ticket"],[1,"ticket-img",3,"animated"],[1,"ticket-data"],[1,"ticket-data-date",3,"animated"],[1,"ticket-data-number",3,"animated"],[1,"ticket-data-prize",3,"animated"],["aria-hidden","true","slot","start","alt","",1,"ticket-img",3,"src"],["color","medium",1,"ticket-data-date"],[1,"ticket-data-number"],[1,"ticket-data-prize"],["class","ticket-actions"],[1,"ticket-actions"],["name","close-outline",1,"ticket-actions-delete",3,"click"]],template:function(i,n){i&1&&r.\u0275\u0275template(0,ie,6,4,"section",0)(1,oe,13,12)(2,re,2,0),i&2&&r.\u0275\u0275conditional(0,n.skeleton?0:n.data.ticket.code===n.gameCodes.LOTERIA_NACIONAL?1:2)},dependencies:[Xt,Y.AsyncPipe,Y.CurrencyPipe,Q,ee,J.IonIcon,J.IonSkeletonText],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   .ticket[_ngcontent-%COMP%]{background-color:#fff;display:flex;flex-direction:row;align-items:flex-start;justify-content:flex-start;margin:15px;border-radius:7px;box-shadow:#63636333 0 2px 8px;padding:15px;min-width:350px}[_nghost-%COMP%]   .ticket-img[_ngcontent-%COMP%]{width:50px;margin:0 15px 0 0}[_nghost-%COMP%]   .ticket-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}[_nghost-%COMP%]   .ticket-data-date[_ngcontent-%COMP%]{margin-bottom:15px}[_nghost-%COMP%]   .ticket-data-number[_ngcontent-%COMP%]{font-size:40px;font-weight:700;letter-spacing:17px;margin-bottom:12px}[_nghost-%COMP%]   .ticket-actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;margin:0 0 0 15px}[_nghost-%COMP%]   .ticket-actions-delete[_ngcontent-%COMP%]{width:30px;height:30px}"],changeDetection:0})}}return e})();import*as c from"@angular/core";import*as wt from"@angular/router";import"@angular/core";import{lastValueFrom as Pt}from"rxjs";import{v4 as ce}from"uuid";import*as B from"@angular/core";import"@angular/core";import{lastValueFrom as ht}from"rxjs";import*as K from"@angular/core";var ae=1e3*60*60*1.5,E=(()=>{class e{constructor(t,i){this.apiSrv=t,this.storageSrv=i,this.apiUser=`${f.api.host}/user`}createUserByUuid(t){return u(this,null,function*(){let i={email:`${t}${b.UUID_EMAIL_DOMAIN}`,password:t,name:t};try{let n=this.apiSrv.post(this.apiUser,i);return yield ht(n)}catch(n){throw n}})}loginByUuid(t){return u(this,null,function*(){return yield this.login(`${t}${b.UUID_EMAIL_DOMAIN}`,t)})}login(t,i){return u(this,null,function*(){let n={email:t,password:i};try{let p=this.apiSrv.post(`${this.apiUser}/login`,n),g=yield ht(p);if(g.token){let D={token:g.token,date:Date.now()};this.storageSrv.setItem(C.TOKEN,JSON.stringify(D)),console.info(G.SYSTEM,`${g.token}`)}return g}catch(p){throw p}})}checkTokenExpiration(t){return u(this,null,function*(){let n=this.storageSrv.getItem(C.TOKEN)?.date||0;Date.now()-n>ae&&(yield this.loginByUuid(t))})}getAllTicketsByUser(){return u(this,null,function*(){try{let t=this.apiSrv.get(`${this.apiUser}/ticket/all?limit=100&offset=0`);return yield ht(t)}catch{return[]}})}static{this.\u0275fac=function(i){return new(i||e)(K.\u0275\u0275inject(I),K.\u0275\u0275inject(x))}}static{this.\u0275prov=K.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();import"@angular/core";import*as X from"@angular/core";var Et=(()=>{class e{constructor(t){this.storageSrv=t}hasShell(){return this.storageSrv.getItem(dt.SHELL_VERSION)==="0.0.0"}static{this.\u0275fac=function(i){return new(i||e)(X.\u0275\u0275inject(x))}}static{this.\u0275prov=X.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var P=(()=>{class e{constructor(t,i,n){this.apiSrv=t,this.userSrv=i,this.coreSrv=n,this.uuid="",this.apiUuid=`${f.api.host}/uuid`,window.addEventListener(L.SHELL_DEVICE_GET_ID_RESPONSE,p=>u(this,null,function*(){let g=localStorage.getItem(C.APP_UUID)||p.detail?.response||"";this.setAppUuid(g),yield this.onDeviceIdResponse()}))}init(){return u(this,null,function*(){yield this.requestDeviceId()})}getUuid(){return this.uuid}updateAppUuid(t){this.setAppUuid(t)}requestDeviceId(){return u(this,null,function*(){if(this.coreSrv.hasShell())window.dispatchEvent(new CustomEvent(L.SHELL_DEVICE_GET_ID));else{let t=localStorage.getItem(C.APP_UUID)||"";this.setAppUuid(t),yield this.onDeviceIdResponse()}})}setAppUuid(t){this.uuid=t,this.uuid||(this.uuid=ce()),localStorage.setItem(C.APP_UUID,this.uuid)}onDeviceIdResponse(){return u(this,null,function*(){(yield this.getUuidData())?(yield this.userSrv.loginByUuid(this.uuid),console.info(G.SYSTEM,`UUID ${this.uuid} was registered.`)):yield this.registerUuid()})}getUuidData(){return u(this,null,function*(){try{let t=this.apiSrv.get(`${this.apiUuid}/${this.uuid}`);return yield Pt(t)}catch{return null}})}registerUuid(){return u(this,null,function*(){let t=yield this.userSrv.createUserByUuid(this.uuid);if((yield this.userSrv.loginByUuid(this.uuid)).token){let n={uuid:this.uuid,user:t._id};try{let p=this.apiSrv.post(this.apiUuid,n),g=yield Pt(p);this.uuid=g.uuid,console.info(G.SYSTEM,`UUID ${this.uuid} has been registered.`)}catch(p){console.error(p)}}})}static{this.\u0275fac=function(i){return new(i||e)(B.\u0275\u0275inject(I),B.\u0275\u0275inject(E),B.\u0275\u0275inject(Et))}}static{this.\u0275prov=B.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();import"@angular/core";import{lastValueFrom as Ct}from"rxjs";import*as tt from"@angular/core";var w=(()=>{class e{constructor(t){this.apiSrv=t,this.apiGame=`${f.api.host}/game`}getAllGamesByCodeOnlyWithPrizes(t){return u(this,null,function*(){try{let i=this.apiSrv.get(`${this.apiGame}?limit=10&offset=0&code=${t}&onlyWithPrizes=true`);return yield Ct(i)}catch{return[]}})}getAllTicketsPrizesByUser(){return u(this,null,function*(){try{let t=this.apiSrv.get(`${this.apiGame}/ticket/all?limit=100&offset=0`);return yield Ct(t)}catch{return[]}})}getTicketPrizeByTicketId(t){return u(this,null,function*(){try{let i=this.apiSrv.get(`${this.apiGame}/ticket/${t}`);return yield Ct(i)}catch{return null}})}static{this.\u0275fac=function(i){return new(i||e)(tt.\u0275\u0275inject(I))}}static{this.\u0275prov=tt.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();import*as et from"@ionic/angular";import*as it from"@ngx-translate/core";function ue(e,h){e&1&&(c.\u0275\u0275elementStart(0,"article"),c.\u0275\u0275text(1,"Camera permission denied."),c.\u0275\u0275elementEnd())}function he(e,h){e&1&&c.\u0275\u0275element(0,"ion-icon",3)}function ge(e,h){if(e&1){let t=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"section",4),c.\u0275\u0275listener("click",function(){c.\u0275\u0275restoreView(t);let n=c.\u0275\u0275nextContext();return c.\u0275\u0275resetView(n.tapTicket(!1))}),c.\u0275\u0275element(1,"app-ticket",5),c.\u0275\u0275elementStart(2,"article")(3,"span"),c.\u0275\u0275text(4),c.\u0275\u0275pipe(5,"translate"),c.\u0275\u0275elementEnd()()()}if(e&2){let t=c.\u0275\u0275nextContext();c.\u0275\u0275advance(1),c.\u0275\u0275property("showActions",!1)("data",t.ticketData),c.\u0275\u0275advance(3),c.\u0275\u0275textInterpolate(c.\u0275\u0275pipeBind1(5,3,"SCAN.MESSAGES.TAP_SCREEN_TO_SCAN"))}}var Ot=(()=>{class e{handleShellScannerResponse(t){return u(this,null,function*(){yield this.onScannerResponse(t.detail?.response||{})})}handleShellScannerError(t){return u(this,null,function*(){yield this.onScannerError(t.detail?.response||{})})}constructor(t,i,n,p,g,D,T,$){this.cdr=t,this.router=i,this.ticketSrv=n,this.uuidSrv=p,this.userSrv=g,this.gameSrv=D,this.loadingCtrl=T,this.translateSrv=$,this.gameCodes=S,this.hasShell=!1,this.responses=[],this.hasPermission=!0,this.ticketData=null,this.showTicket=!1,this.backgroundColor=""}ngOnInit(){}ngAfterViewInit(){}ionViewDidEnter(){return u(this,null,function*(){this.setTicketVisibility(!1),document.body.style.backgroundColor="transparent",yield this.startScan()})}ionViewWillLeave(){this.setTicketVisibility(!1),document.body.style.backgroundColor=this.backgroundColor,this.stopScan()}startScan(t){return u(this,null,function*(){this.hasPermission=!0,window.dispatchEvent(new CustomEvent(L.SHELL_SCANNER_START))})}stopScan(t){window.dispatchEvent(new CustomEvent(L.SHELL_SCANNER_STOP))}permissionResponse(t){this.hasPermission=t||!1}setTicketVisibility(t){this.showTicket=t,this.cdr.detectChanges()}tapTicket(t){return u(this,null,function*(){this.setTicketVisibility(!1),yield this.startScan()})}onScannerResponse(t){return u(this,null,function*(){if(this.checkUuidQRCode(t.content||"")){let i=t.content.toString().replace(b.UUID_QR_CODE,"");this.uuidSrv.updateAppUuid(i),yield this.userSrv.loginByUuid(i)}else if(t&&!t.closed){this.showLoading();let i="";try{i=(yield this.ticketSrv.createNewTicket(t.content||""))._id||""}catch(n){i=n.error?.ticket?._id||""}this.ticketData=yield this.gameSrv.getTicketPrizeByTicketId(i),this.dismissLoading(),this.setTicketVisibility(!0)}})}onScannerError(t){return u(this,null,function*(){console.log(t),this.hasPermission=!1})}checkUuidQRCode(t){return!!t.toString().includes(b.UUID_QR_CODE)}showLoading(){return u(this,null,function*(){(yield this.loadingCtrl.create({message:yield this.translateSrv.instant("SCAN.MESSAGES.CHECKING_TICKETS"),duration:5e3})).present()})}dismissLoading(){return u(this,null,function*(){yield this.loadingCtrl.dismiss()})}static{this.\u0275fac=function(i){return new(i||e)(c.\u0275\u0275directiveInject(c.ChangeDetectorRef),c.\u0275\u0275directiveInject(wt.Router),c.\u0275\u0275directiveInject(M),c.\u0275\u0275directiveInject(P),c.\u0275\u0275directiveInject(E),c.\u0275\u0275directiveInject(w),c.\u0275\u0275directiveInject(et.LoadingController),c.\u0275\u0275directiveInject(it.TranslateService))}}static{this.\u0275cmp=c.\u0275\u0275defineComponent({type:e,selectors:[["app-scan"]],hostBindings:function(i,n){i&1&&c.\u0275\u0275listener("shellScannerResponse",function(g){return n.handleShellScannerResponse(g)},!1,c.\u0275\u0275resolveWindow)("shellScannerError",function(g){return n.handleShellScannerError(g)},!1,c.\u0275\u0275resolveWindow)},standalone:!0,features:[c.\u0275\u0275StandaloneFeature],decls:5,vars:2,consts:[[1,"scan"],[1,"scan-screen"],["class","ticket-background"],["name","add-outline",1,"scan-screen-pointer"],[1,"ticket-background",3,"click"],[3,"showActions","data"]],template:function(i,n){i&1&&(c.\u0275\u0275elementStart(0,"section",0)(1,"section",1),c.\u0275\u0275template(2,ue,2,0,"article")(3,he,1,0),c.\u0275\u0275elementEnd()(),c.\u0275\u0275template(4,ge,6,5,"section",2)),i&2&&(c.\u0275\u0275advance(2),c.\u0275\u0275conditional(2,n.hasPermission?3:2),c.\u0275\u0275advance(2),c.\u0275\u0275conditional(4,n.showTicket?4:-1))},dependencies:[le,me,de,et.IonIcon,pe,it.TranslatePipe,Z],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   .scan[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:flex-start;height:calc(100vh - env(safe-area-inset-bottom,0));margin:0}[_nghost-%COMP%]   .scan-screen[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:calc(100% - env(safe-area-inset-bottom,0))}[_nghost-%COMP%]   .scan-screen-pointer[_ngcontent-%COMP%]{width:40px;color:#fff;height:40px}[_nghost-%COMP%]   .ticket-background[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:center;position:absolute;width:100%;height:100vh;top:0}ion-modal[_ngcontent-%COMP%]{--height: 200px;--border-radius: 8px;--box-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--background: transparent}ion-modal[_ngcontent-%COMP%]   ion-content[_ngcontent-%COMP%]{--background: transparent}ion-modal[_ngcontent-%COMP%]   .ticket-ln[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}ion-modal[_ngcontent-%COMP%]   .ticket-ln-number[_ngcontent-%COMP%]{font-size:40px;font-weight:700;letter-spacing:17px;margin:20px 20px 20px 37px}ion-modal[_ngcontent-%COMP%]   .ticket-ln-prize[_ngcontent-%COMP%]{font-size:20px;font-weight:700}ion-modal[_ngcontent-%COMP%]::part(content){background-color:transparent;border:none;box-shadow:none}ion-modal[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{padding:0}"],changeDetection:0})}}return e})();import{CommonModule as fe}from"@angular/common";import"@angular/core";import{RouterModule as Ce}from"@angular/router";import{IonicModule as ve}from"@ionic/angular";import{TranslateModule as _e}from"@ngx-translate/core";import*as m from"@angular/core";import*as Dt from"@angular/router";import*as O from"@ionic/angular";import*as Lt from"@ngx-translate/core";var Se=["mainTabs"],At=(()=>{class e{constructor(t){this.router=t}ngOnInit(){}ngAfterViewInit(){setTimeout(()=>{this.mainTabs.select("games")},500)}static{this.\u0275fac=function(i){return new(i||e)(m.\u0275\u0275directiveInject(Dt.Router))}}static{this.\u0275cmp=m.\u0275\u0275defineComponent({type:e,selectors:[["app-main"]],viewQuery:function(i,n){if(i&1&&m.\u0275\u0275viewQuery(Se,5),i&2){let p;m.\u0275\u0275queryRefresh(p=m.\u0275\u0275loadQuery())&&(n.mainTabs=p.first)}},standalone:!0,features:[m.\u0275\u0275StandaloneFeature],decls:23,vars:12,consts:[["mainTabs",""],["slot","bottom"],["tab","games"],["name","grid-outline"],["tab","scan"],["name","scan-outline"],["tab","tickets"],["name","wallet-outline"],["tab","menu"],["name","cog-outline"]],template:function(i,n){i&1&&(m.\u0275\u0275elementStart(0,"ion-tabs",null,0)(2,"ion-tab-bar",1)(3,"ion-tab-button",2),m.\u0275\u0275element(4,"ion-icon",3),m.\u0275\u0275elementStart(5,"span"),m.\u0275\u0275text(6),m.\u0275\u0275pipe(7,"translate"),m.\u0275\u0275elementEnd()(),m.\u0275\u0275elementStart(8,"ion-tab-button",4),m.\u0275\u0275element(9,"ion-icon",5),m.\u0275\u0275elementStart(10,"span"),m.\u0275\u0275text(11),m.\u0275\u0275pipe(12,"translate"),m.\u0275\u0275elementEnd()(),m.\u0275\u0275elementStart(13,"ion-tab-button",6),m.\u0275\u0275element(14,"ion-icon",7),m.\u0275\u0275elementStart(15,"span"),m.\u0275\u0275text(16),m.\u0275\u0275pipe(17,"translate"),m.\u0275\u0275elementEnd()(),m.\u0275\u0275elementStart(18,"ion-tab-button",8),m.\u0275\u0275element(19,"ion-icon",9),m.\u0275\u0275elementStart(20,"span"),m.\u0275\u0275text(21),m.\u0275\u0275pipe(22,"translate"),m.\u0275\u0275elementEnd()()()()),i&2&&(m.\u0275\u0275advance(6),m.\u0275\u0275textInterpolate(m.\u0275\u0275pipeBind1(7,4,"MAIN.TABS.GAMES")),m.\u0275\u0275advance(5),m.\u0275\u0275textInterpolate(m.\u0275\u0275pipeBind1(12,6,"MAIN.TABS.SCAN_NOW")),m.\u0275\u0275advance(5),m.\u0275\u0275textInterpolate(m.\u0275\u0275pipeBind1(17,8,"MAIN.TABS.TICKETS")),m.\u0275\u0275advance(5),m.\u0275\u0275textInterpolate(m.\u0275\u0275pipeBind1(22,10,"MAIN.TABS.MENU")))},dependencies:[fe,Ce,ve,O.IonIcon,O.IonTabBar,O.IonTabButton,O.IonTabs,_e,Lt.TranslatePipe],styles:["[_nghost-%COMP%]{display:block}ion-tabs[_ngcontent-%COMP%]{padding:env(safe-area-inset-top,0) env(safe-area-inset-right,0) 0 env(safe-area-inset-left,0)}ion-tabs[_ngcontent-%COMP%]   ion-tab-bar[_ngcontent-%COMP%]{padding-bottom:env(safe-area-inset-bottom,0)}"],changeDetection:0})}}return e})();import{CommonModule as xe}from"@angular/common";import{HttpClient as Ie,HttpClientModule as ke}from"@angular/common/http";import"@angular/core";import{NavigationEnd as Te,RouterModule as be}from"@angular/router";import{filter as Me}from"rxjs";import{IonicModule as Ee}from"@ionic/angular";import{TranslateLoader as Pe,TranslateModule as we}from"@ngx-translate/core";import"@angular/core";import{catchError as ye}from"rxjs/operators";import*as nt from"@angular/core";import*as Ut from"@angular/common/http";var Gt=(()=>{class e{constructor(t){this.httpClient=t}getTranslation(t){let i=f.web.host+`/assets/i18n/${t}.json`;return this.httpClient.get(i).pipe(ye(n=>(console.log("Error loading translation file",n),this.httpClient.get(f.web.host+"/assets/i18n/es.json"))))}static{this.\u0275fac=function(i){return new(i||e)(nt.\u0275\u0275inject(Ut.HttpClient))}}static{this.\u0275prov=nt.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac})}}return e})();import*as v from"@angular/core";import*as jt from"@ngx-translate/core";import*as ot from"@angular/router";var Nt=(()=>{class e{constructor(t,i,n,p,g){this.translateSrv=t,this.uuidSrv=i,this.userSrv=n,this.storageSrv=p,this.router=g,this.translateSrv.setDefaultLang("en"),this.translateSrv.use("en")}ngOnInit(){this.setNoErrorLoadingRemote(),this.importStyles(),this.importScripts(),this.uuidSrv.init(),this.router.events.pipe(Me(t=>t instanceof Te)).subscribe(t=>{let i=this.uuidSrv.getUuid();i?this.userSrv.checkTokenExpiration(i):this.uuidSrv.init()}),this.loadLanguage()}loadLanguage(){let t=this.storageSrv.getItem(C.LANGUAGE)||U.EN;this.translateSrv.use(t)}setNoErrorLoadingRemote(){this.storageSrv.setItem(pt.SHELL_LOADING_REMOTE_OK,"true")}importScripts(){let t=["https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.esm.js","https://cdn.jsdelivr.net/npm/ionicons/dist/ionicons/ionicons.esm.js"],i=document.head;t.forEach(n=>{let p=document.createElement("script");p.type="module",p.src=n,p.async=!1,document.head.appendChild(p),i.insertBefore(p,i.firstElementChild)})}importStyles(){let t=["https://cdn.jsdelivr.net/npm/@ionic/core/css/ionic.bundle.css"],i=document.head;t.forEach(n=>{let p=document.createElement("link");p.rel="stylesheet",p.href=n,i.insertBefore(p,i.firstElementChild)})}static{this.\u0275fac=function(i){return new(i||e)(v.\u0275\u0275directiveInject(jt.TranslateService),v.\u0275\u0275directiveInject(P),v.\u0275\u0275directiveInject(E),v.\u0275\u0275directiveInject(x),v.\u0275\u0275directiveInject(ot.Router))}}static{this.\u0275cmp=v.\u0275\u0275defineComponent({type:e,selectors:[["app-remote-app"]],standalone:!0,features:[v.\u0275\u0275ProvidersFeature([I,P,E,M,w,we.forRoot({loader:{provide:Pe,useClass:Gt,deps:[Ie]}}).providers]),v.\u0275\u0275StandaloneFeature],decls:1,vars:0,template:function(i,n){i&1&&v.\u0275\u0275element(0,"router-outlet")},dependencies:[xe,be,ot.RouterOutlet,Ee,ke],styles:[`:root{--color-background: var(--ion-tab-bar-background, var(--ion-color-step-50, #f7f7f7));--box-shadow: rgba(99, 99, 99, .2) 0px 2px 8px 0px}:host{display:block}body{--ion-color-primary: #3880ff;--ion-color-primary-rgb: 56,128,255;--ion-color-primary-contrast: #ffffff;--ion-color-primary-contrast-rgb: 255,255,255;--ion-color-primary-shade: #3171e0;--ion-color-primary-tint: #4c8dff;--ion-color-secondary: #3dc2ff;--ion-color-secondary-rgb: 61,194,255;--ion-color-secondary-contrast: #000000;--ion-color-secondary-contrast-rgb: 0,0,0;--ion-color-secondary-shade: #36abe0;--ion-color-secondary-tint: #50c8ff;--ion-color-tertiary: #5260ff;--ion-color-tertiary-rgb: 82,96,255;--ion-color-tertiary-contrast: #ffffff;--ion-color-tertiary-contrast-rgb: 255,255,255;--ion-color-tertiary-shade: #4854e0;--ion-color-tertiary-tint: #6370ff;--ion-color-success: #2dd36f;--ion-color-success-rgb: 45,211,111;--ion-color-success-contrast: #000000;--ion-color-success-contrast-rgb: 0,0,0;--ion-color-success-shade: #28ba62;--ion-color-success-tint: #42d77d;--ion-color-warning: #ffc409;--ion-color-warning-rgb: 255,196,9;--ion-color-warning-contrast: #000000;--ion-color-warning-contrast-rgb: 0,0,0;--ion-color-warning-shade: #e0ac08;--ion-color-warning-tint: #ffca22;--ion-color-danger: #eb445a;--ion-color-danger-rgb: 235,68,90;--ion-color-danger-contrast: #000000;--ion-color-danger-contrast-rgb: 0,0,0;--ion-color-danger-shade: #cf3c4f;--ion-color-danger-tint: #ed576b;--ion-color-light: #f4f5f8;--ion-color-light-rgb: 244,245,248;--ion-color-light-contrast: #000000;--ion-color-light-contrast-rgb: 0,0,0;--ion-color-light-shade: #d7d8da;--ion-color-light-tint: #f5f6f9;--ion-color-medium: #92949c;--ion-color-medium-rgb: 146,148,156;--ion-color-medium-contrast: #000000;--ion-color-medium-contrast-rgb: 0,0,0;--ion-color-medium-shade: #808289;--ion-color-medium-tint: #9d9fa6;--ion-color-dark: #222428;--ion-color-dark-rgb: 34,36,40;--ion-color-dark-contrast: #ffffff;--ion-color-dark-contrast-rgb: 255,255,255;--ion-color-dark-shade: #1e2023;--ion-color-dark-tint: #383a3e;--background: var(--color-background);background:var(--background)}
`],encapsulation:2,changeDetection:0})}}return e})();import{CommonModule as Le}from"@angular/common";import"@angular/core";import{RouterModule as Ae}from"@angular/router";import{IonicModule as Ue}from"@ionic/angular";import{CommonModule as Co}from"@angular/common";import"@angular/core";import{IonicModule as Io}from"@ionic/angular";import*as A from"@angular/core";import*as Oe from"@angular/router";import*as De from"@ngx-translate/core";import*as _t from"@ionic/angular";import{TranslateModule as Ge}from"@ngx-translate/core";import*as l from"@angular/core";import*as k from"@ionic/angular";import*as rt from"@ngx-translate/core";var je=(e,h)=>h.ticket._id;function Ne(e,h){if(e&1){let t=l.\u0275\u0275getCurrentView();l.\u0275\u0275elementStart(0,"app-ticket",4),l.\u0275\u0275listener("deleteTicketEvent",function(n){l.\u0275\u0275restoreView(t);let p=l.\u0275\u0275nextContext(2);return l.\u0275\u0275resetView(p.deleteTicketById(n))}),l.\u0275\u0275elementEnd()}if(e&2){let t=h.$implicit;l.\u0275\u0275property("data",t)}}function Re(e,h){if(e&1&&(l.\u0275\u0275elementStart(0,"ion-list",3),l.\u0275\u0275repeaterCreate(1,Ne,1,1,"app-ticket",5,je),l.\u0275\u0275elementEnd()),e&2){let t=l.\u0275\u0275nextContext();l.\u0275\u0275advance(1),l.\u0275\u0275repeater(t.tickets)}}function Be(e,h){e&1&&(l.\u0275\u0275elementStart(0,"section",6),l.\u0275\u0275element(1,"ion-icon",7),l.\u0275\u0275elementStart(2,"span",8),l.\u0275\u0275text(3),l.\u0275\u0275pipe(4,"translate"),l.\u0275\u0275elementEnd()()),e&2&&(l.\u0275\u0275advance(3),l.\u0275\u0275textInterpolate(l.\u0275\u0275pipeBind1(4,1,"TICKETS.EMPTY_TICKET_LIST")))}function ze(e,h){e&1&&(l.\u0275\u0275elementStart(0,"section",9),l.\u0275\u0275element(1,"ion-spinner",10),l.\u0275\u0275elementEnd())}var Rt=(()=>{class e{constructor(t,i,n,p,g){this.cdr=t,this.ticketSrv=i,this.gameSrv=n,this.loadingCtrl=p,this.translateSrv=g,this.tickets=[],this.environment=f,this.loadingCount=0}ionViewDidEnter(){return u(this,null,function*(){yield this.getUserTickets(),this.sortTicketsByDate()})}sortTicketsByDate(){this.tickets.sort((t,i)=>{let n=new Date(t.ticket.date);return new Date(i.ticket.date).getTime()-n.getTime()}),this.cdr.detectChanges()}deleteTicketById(t){return u(this,null,function*(){t&&(yield this.getUserTickets())})}getUserTickets(){return u(this,null,function*(){this.showLoading();try{this.tickets=yield this.gameSrv.getAllTicketsPrizesByUser(),this.requestHideLoading(),this.cdr.detectChanges()}catch{this.dismissLoading()}})}showLoading(){return u(this,null,function*(){let t=this.loadingCount;this.loadingCount++,t===0&&this.cdr.detectChanges()})}requestHideLoading(){return u(this,null,function*(){this.loadingCount--,this.loadingCount<=0&&this.dismissLoading()})}dismissLoading(){return u(this,null,function*(){this.loadingCount=0,this.cdr.detectChanges()})}static{this.\u0275fac=function(i){return new(i||e)(l.\u0275\u0275directiveInject(l.ChangeDetectorRef),l.\u0275\u0275directiveInject(M),l.\u0275\u0275directiveInject(w),l.\u0275\u0275directiveInject(k.LoadingController),l.\u0275\u0275directiveInject(rt.TranslateService))}}static{this.\u0275cmp=l.\u0275\u0275defineComponent({type:e,selectors:[["app-tickets"]],standalone:!0,features:[l.\u0275\u0275StandaloneFeature],decls:4,vars:2,consts:[["padding","","color","light"],["class","ticket-list"],["class","loading-content"],[1,"ticket-list"],[3,"data","deleteTicketEvent"],[3,"data"],[1,"empty-content"],["name","scan-circle-outline",1,"empty-content-icon"],[1,"empty-content-message"],[1,"loading-content"],["name","circular"]],template:function(i,n){i&1&&(l.\u0275\u0275elementStart(0,"ion-content",0),l.\u0275\u0275template(1,Re,3,0,"ion-list",1)(2,Be,5,3)(3,ze,2,0,"section",2),l.\u0275\u0275elementEnd()),i&2&&(l.\u0275\u0275advance(1),l.\u0275\u0275conditional(1,n.tickets.length?1:2),l.\u0275\u0275advance(2),l.\u0275\u0275conditional(3,n.loadingCount>0?3:-1))},dependencies:[Le,Ae,Ue,k.IonContent,k.IonIcon,k.IonList,k.IonSpinner,Ge,rt.TranslatePipe,Z],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{height:100vh;width:100vw;padding-top:50px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]::part(scroll){overscroll-behavior:none;overflow:scroll}[_nghost-%COMP%]   .ticket-list[_ngcontent-%COMP%]{background-color:transparent;display:grid;gap:5px;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));margin-bottom:150px}[_nghost-%COMP%]   .empty-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:300px}[_nghost-%COMP%]   .empty-content-icon[_ngcontent-%COMP%]{width:120px;height:120px;color:gray}[_nghost-%COMP%]   .empty-content-message[_ngcontent-%COMP%]{color:gray;margin:20px}[_nghost-%COMP%]   .loading-content[_ngcontent-%COMP%]{position:fixed;top:0;z-index:9;width:100vw;height:100vh;display:flex;align-items:center;justify-content:center;background-color:#00000040}"],changeDetection:0})}}return e})();import{CommonModule as Ve}from"@angular/common";import"@angular/core";import{IonicModule as He}from"@ionic/angular";import{QrCodeModule as $e}from"ng-qrcode";import{RouterModule as Fe}from"@angular/router";import{TranslateModule as Ke}from"@ngx-translate/core";import*as d from"@angular/core";import*as at from"@ngx-translate/core";import*as Bt from"@angular/common";import*as y from"@ionic/angular";import*as zt from"ng-qrcode";function qe(e,h){if(e&1&&d.\u0275\u0275element(0,"qr-code",7),e&2){let t=d.\u0275\u0275nextContext();d.\u0275\u0275property("value",t.qrUuid)}}var Vt=(()=>{class e{constructor(t,i,n,p){this.cdr=t,this.uuidSrv=i,this.storageSrv=n,this.translateSrv=p,this.qrUuid="",this.languages=U,this.currentLanguage=this.storageSrv.getItem(C.LANGUAGE)||U.EN}ionViewDidEnter(){this.qrUuid=b.UUID_QR_CODE+this.uuidSrv.getUuid(),this.cdr.detectChanges()}changeLanguage(t){this.storageSrv.setItem(C.LANGUAGE,t),this.translateSrv.use(t),this.cdr.detectChanges()}static{this.\u0275fac=function(i){return new(i||e)(d.\u0275\u0275directiveInject(d.ChangeDetectorRef),d.\u0275\u0275directiveInject(P),d.\u0275\u0275directiveInject(x),d.\u0275\u0275directiveInject(at.TranslateService))}}static{this.\u0275cmp=d.\u0275\u0275defineComponent({type:e,selectors:[["app-menu"]],standalone:!0,features:[d.\u0275\u0275StandaloneFeature],decls:13,vars:11,consts:[["padding","","color","light"],[1,"menu-list"],[1,"menu-list-qr"],["size","300","errorCorrectionLevel","M",3,"value",4,"ngIf"],["interface","action-sheet",3,"label","value","ionChange"],["value","en"],["value","es"],["size","300","errorCorrectionLevel","M",3,"value"]],template:function(i,n){i&1&&(d.\u0275\u0275elementStart(0,"ion-content",0)(1,"ion-list",1)(2,"section",2),d.\u0275\u0275template(3,qe,1,1,"qr-code",3),d.\u0275\u0275elementEnd(),d.\u0275\u0275elementStart(4,"ion-item")(5,"ion-select",4),d.\u0275\u0275listener("ionChange",function(g){return n.changeLanguage(g.detail.value)}),d.\u0275\u0275pipe(6,"translate"),d.\u0275\u0275elementStart(7,"ion-select-option",5),d.\u0275\u0275text(8),d.\u0275\u0275pipe(9,"translate"),d.\u0275\u0275elementEnd(),d.\u0275\u0275elementStart(10,"ion-select-option",6),d.\u0275\u0275text(11),d.\u0275\u0275pipe(12,"translate"),d.\u0275\u0275elementEnd()()()()()),i&2&&(d.\u0275\u0275advance(3),d.\u0275\u0275property("ngIf",n.qrUuid),d.\u0275\u0275advance(2),d.\u0275\u0275propertyInterpolate("label",d.\u0275\u0275pipeBind1(6,5,"GLOBAL.LANGUAGES")),d.\u0275\u0275propertyInterpolate("value",n.currentLanguage),d.\u0275\u0275advance(3),d.\u0275\u0275textInterpolate(d.\u0275\u0275pipeBind1(9,7,"GLOBAL.ENGLISH")),d.\u0275\u0275advance(3),d.\u0275\u0275textInterpolate(d.\u0275\u0275pipeBind1(12,9,"GLOBAL.SPANISH")))},dependencies:[Ve,Bt.NgIf,He,y.IonContent,y.IonItem,y.IonList,y.IonSelect,y.IonSelectOption,y.SelectValueAccessor,Fe,$e,zt.QrCodeComponent,Ke,at.TranslatePipe],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{height:100vh;width:100vw;padding-top:50px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]::part(scroll){overscroll-behavior:none;overflow:scroll}[_nghost-%COMP%]   .menu-list-qr[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;margin:10px 0 30px}[_nghost-%COMP%]   .menu-list-option[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;align-items:flex-start}"],changeDetection:0})}}return e})();import{CommonModule as ii}from"@angular/common";import"@angular/core";import{RouterModule as ni}from"@angular/router";import{IonicModule as oi}from"@ionic/angular";import{TranslateModule as ri}from"@ngx-translate/core";import{CommonModule as Qe}from"@angular/common";import"@angular/core";import{IonicModule as We}from"@ionic/angular";import{TranslateModule as Ye}from"@ngx-translate/core";import*as o from"@angular/core";import"@angular/core";import*as Ht from"@angular/core";var st=(()=>{class e{constructor(){}getBestPrizes(t){return JSON.parse(t)}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=Ht.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();import*as z from"@angular/common";import*as ct from"@ionic/angular";function Je(e,h){if(e&1&&(o.\u0275\u0275elementStart(0,"ion-item",8)(1,"ion-label",9)(2,"span",10),o.\u0275\u0275text(3),o.\u0275\u0275elementEnd()(),o.\u0275\u0275elementStart(4,"ion-label",11),o.\u0275\u0275text(5),o.\u0275\u0275pipe(6,"currency"),o.\u0275\u0275elementEnd()()),e&2){let t=o.\u0275\u0275nextContext();o.\u0275\u0275advance(1),o.\u0275\u0275property("ngClass","game-more-best-prize-first-number"),o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(t.bestGamePrizes.primerPremio.decimo),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngClass","game-more-best-prize-first-quantity"),o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind2(6,4,t.bestGamePrizes.primerPremio.prize/100,"EUR"))}}function Ze(e,h){if(e&1&&(o.\u0275\u0275elementStart(0,"ion-item",12)(1,"ion-label",9)(2,"span",10),o.\u0275\u0275text(3),o.\u0275\u0275elementEnd()(),o.\u0275\u0275elementStart(4,"ion-label",11),o.\u0275\u0275text(5),o.\u0275\u0275pipe(6,"currency"),o.\u0275\u0275elementEnd()()),e&2){let t=o.\u0275\u0275nextContext();o.\u0275\u0275advance(1),o.\u0275\u0275property("ngClass","game-more-best-prize-second-number"),o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(t.bestGamePrizes.segundoPremio.decimo),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngClass","game-more-best-prize-second-quantity"),o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind2(6,4,t.bestGamePrizes.segundoPremio.prize/100,"EUR"))}}var Xe=(e,h)=>h.decimo;function ti(e,h){if(e&1&&(o.\u0275\u0275elementStart(0,"span",10),o.\u0275\u0275text(1),o.\u0275\u0275elementEnd()),e&2){let t=h.$implicit;o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate(t.decimo)}}function ei(e,h){if(e&1&&(o.\u0275\u0275elementStart(0,"ion-item")(1,"ion-label",9),o.\u0275\u0275repeaterCreate(2,ti,2,1,"span",13,Xe),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(4,"ion-label",11),o.\u0275\u0275text(5),o.\u0275\u0275pipe(6,"currency"),o.\u0275\u0275elementEnd()()),e&2){let t=o.\u0275\u0275nextContext();o.\u0275\u0275advance(1),o.\u0275\u0275property("ngClass","game-more-best-prize-third-number"),o.\u0275\u0275advance(1),o.\u0275\u0275repeater(t.bestGamePrizes.reintegros),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngClass","game-more-best-prize-third-quantity"),o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind2(6,3,t.bestGamePrizes.reintegros[0].prize/100,"EUR"))}}var lt=(()=>{class e{constructor(t){this.lnSrv=t,this.environment=f,this.gameCodes=S,this.bestGamePrizes={}}ngOnInit(){this.getBestPrizes()}getBestPrizes(){this.bestGamePrizes=this.lnSrv.getBestPrizes(this.data.data.info.raw)}static{this.\u0275fac=function(i){return new(i||e)(o.\u0275\u0275directiveInject(st))}}static{this.\u0275cmp=o.\u0275\u0275defineComponent({type:e,selectors:[["app-game-ln"]],inputs:{data:"data"},standalone:!0,features:[o.\u0275\u0275StandaloneFeature],decls:13,vars:9,consts:[[1,"game"],[1,"row"],["aria-hidden","true","slot","start","alt","",1,"game-img",3,"src"],[1,"game-data"],["color","medium",1,"game-data-date"],[1,"game-more"],["class","game-more-best-prize-first"],["class","game-more-best-prize-second"],[1,"game-more-best-prize-first"],[3,"ngClass"],[1,"ball"],["slot","end",3,"ngClass"],[1,"game-more-best-prize-second"],["class","ball"]],template:function(i,n){i&1&&(o.\u0275\u0275elementStart(0,"section",0)(1,"article",1),o.\u0275\u0275element(2,"img",2),o.\u0275\u0275elementStart(3,"section",3)(4,"span",4),o.\u0275\u0275text(5),o.\u0275\u0275pipe(6,"async"),o.\u0275\u0275pipe(7,"date"),o.\u0275\u0275elementEnd()()(),o.\u0275\u0275elementStart(8,"article",1)(9,"section",5),o.\u0275\u0275template(10,Je,7,7,"ion-item",6)(11,Ze,7,7,"ion-item",7)(12,ei,7,6,"ion-item"),o.\u0275\u0275elementEnd()()()),i&2&&(o.\u0275\u0275advance(2),o.\u0275\u0275property("src",n.environment.web.host+"/assets/logos/games/"+n.data.code+".png",o.\u0275\u0275sanitizeUrl),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(6,5,o.\u0275\u0275pipeBind1(7,7,n.data.date))),o.\u0275\u0275advance(5),o.\u0275\u0275conditional(10,n.bestGamePrizes.primerPremio?10:-1),o.\u0275\u0275advance(1),o.\u0275\u0275conditional(11,n.bestGamePrizes.segundoPremio?11:-1),o.\u0275\u0275advance(1),o.\u0275\u0275conditional(12,n.bestGamePrizes.reintegros?12:-1))},dependencies:[Qe,z.NgClass,z.AsyncPipe,z.CurrencyPipe,Q,We,ct.IonItem,ct.IonLabel,Ye],styles:["[_ngcontent-%COMP%]:root{--color-background: var(--ion-tab-bar-background, var(--ion-color-step-50, #f7f7f7));--box-shadow: rgba(99, 99, 99, .2) 0px 2px 8px 0px}[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   .game[_ngcontent-%COMP%]{background-color:#fff;display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;margin:15px;border-radius:7px;box-shadow:var(--box-shadow);padding:15px}[_nghost-%COMP%]   .game[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-start;justify-content:flex-start;width:100%}[_nghost-%COMP%]   .game-img[_ngcontent-%COMP%]{width:50px;margin:0 15px 0 0}[_nghost-%COMP%]   .game-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}[_nghost-%COMP%]   .game-data-date[_ngcontent-%COMP%]{margin-bottom:15px;text-align:right}[_nghost-%COMP%]   .game-more[_ngcontent-%COMP%]{width:100%;margin-top:15px}[_nghost-%COMP%]   .game-more[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]::part(native){padding:0}[_nghost-%COMP%]   .game-more[_ngcontent-%COMP%]   .ball[_ngcontent-%COMP%]{background:#3478b3;color:#fff;padding:5px 10px;border-radius:20px;margin-right:10px}[_nghost-%COMP%]   .game-more-best-prize-first-quantity[_ngcontent-%COMP%]{font-weight:700}"],changeDetection:0})}}return e})();import*as s from"@angular/core";import*as Ft from"@angular/router";import*as V from"@ionic/angular";import*as Kt from"@ngx-translate/core";var ai=(e,h)=>h._id;function si(e,h){if(e&1&&s.\u0275\u0275element(0,"app-game-ln",5),e&2){let t=s.\u0275\u0275nextContext().$implicit;s.\u0275\u0275property("data",t)}}function ci(e,h){if(e&1){let t=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"span",4),s.\u0275\u0275listener("click",function(){let p=s.\u0275\u0275restoreView(t).$implicit,g=s.\u0275\u0275nextContext(2);return s.\u0275\u0275resetView(g.openGame(p))}),s.\u0275\u0275template(1,si,1,1,"app-game-ln",5),s.\u0275\u0275elementEnd()}if(e&2){let t=h.$implicit,i=s.\u0275\u0275nextContext(2);s.\u0275\u0275advance(1),s.\u0275\u0275conditional(1,t.code===i.gamesCodes.LOTERIA_NACIONAL?1:-1)}}function li(e,h){if(e&1&&(s.\u0275\u0275elementStart(0,"section",3),s.\u0275\u0275repeaterCreate(1,ci,2,1,"span",6,ai),s.\u0275\u0275elementEnd()),e&2){let t=s.\u0275\u0275nextContext();s.\u0275\u0275advance(1),s.\u0275\u0275repeater(t.games)}}function mi(e,h){e&1&&(s.\u0275\u0275elementStart(0,"section",7),s.\u0275\u0275element(1,"ion-icon",8),s.\u0275\u0275elementStart(2,"span",9),s.\u0275\u0275text(3),s.\u0275\u0275pipe(4,"translate"),s.\u0275\u0275elementEnd()()),e&2&&(s.\u0275\u0275advance(3),s.\u0275\u0275textInterpolate(s.\u0275\u0275pipeBind1(4,1,"GAMES.EMPTY_GAME_LIST")))}function di(e,h){e&1&&(s.\u0275\u0275elementStart(0,"section",10),s.\u0275\u0275element(1,"ion-spinner",11),s.\u0275\u0275elementEnd())}var qt=(()=>{class e{constructor(t,i,n){this.cdr=t,this.gameSrv=i,this.router=n,this.games=[],this.gamesCodes=S,this.loadingCount=0}ionViewDidEnter(){return u(this,null,function*(){this.games=[],yield this.getGamesByCodeOnlyWithPrizes(S.LOTERIA_NACIONAL),this.filterGamesWithPrizes(),this.sortGamesByDate(),this.cdr.detectChanges()})}openGame(t){this.router.navigate(["/main/","game-detail-"+S.LOTERIA_NACIONAL],{state:{game:t}})}filterGamesWithPrizes(){this.games=this.games.filter(t=>t.data.info.prizes.length>0)}sortGamesByDate(){this.games.sort((t,i)=>{let n=new Date(t.date);return new Date(i.date).getTime()-n.getTime()})}getGamesByCodeOnlyWithPrizes(t){return u(this,null,function*(){try{this.showLoading();let i=yield this.gameSrv.getAllGamesByCodeOnlyWithPrizes(t);this.games=this.games.concat(i),this.cdr.detectChanges(),this.dismissLoading()}catch(i){console.log("Error getting games by code",i),this.dismissLoading()}})}showLoading(){return u(this,null,function*(){let t=this.loadingCount;this.loadingCount++,t===0&&this.cdr.detectChanges()})}requestHideLoading(){return u(this,null,function*(){this.loadingCount--,this.loadingCount<=0&&this.dismissLoading()})}dismissLoading(){return u(this,null,function*(){this.loadingCount=0,this.cdr.detectChanges()})}static{this.\u0275fac=function(i){return new(i||e)(s.\u0275\u0275directiveInject(s.ChangeDetectorRef),s.\u0275\u0275directiveInject(w),s.\u0275\u0275directiveInject(Ft.Router))}}static{this.\u0275cmp=s.\u0275\u0275defineComponent({type:e,selectors:[["app-games"]],standalone:!0,features:[s.\u0275\u0275StandaloneFeature],decls:4,vars:2,consts:[["padding","","color","light"],["class","main-container"],["class","loading-content"],[1,"main-container"],[1,"main-container-element",3,"click"],[3,"data"],["class","main-container-element"],[1,"empty-content"],["name","scan-circle-outline",1,"empty-content-icon"],[1,"empty-content-message"],[1,"loading-content"],["name","circular"]],template:function(i,n){i&1&&(s.\u0275\u0275elementStart(0,"ion-content",0),s.\u0275\u0275template(1,li,3,0,"section",1)(2,mi,5,3)(3,di,2,0,"section",2),s.\u0275\u0275elementEnd()),i&2&&(s.\u0275\u0275advance(1),s.\u0275\u0275conditional(1,n.games.length?1:2),s.\u0275\u0275advance(2),s.\u0275\u0275conditional(3,n.loadingCount>0?3:-1))},dependencies:[ii,ni,oi,V.IonContent,V.IonIcon,V.IonSpinner,ri,Kt.TranslatePipe,lt],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{height:100vh;width:100vw;padding-top:50px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]::part(scroll){overscroll-behavior:none;overflow:scroll}[_nghost-%COMP%]   .main-container[_ngcontent-%COMP%]{display:grid;gap:5px;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));margin-bottom:150px}[_nghost-%COMP%]   .empty-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:300px}[_nghost-%COMP%]   .empty-content-icon[_ngcontent-%COMP%]{width:120px;height:120px;color:gray}[_nghost-%COMP%]   .empty-content-message[_ngcontent-%COMP%]{color:gray;margin:20px}[_nghost-%COMP%]   .loading-content[_ngcontent-%COMP%]{position:fixed;top:0;z-index:9;width:100vw;height:100vh;display:flex;align-items:center;justify-content:center;background-color:#00000040}"],changeDetection:0})}}return e})();import{CommonModule as pi}from"@angular/common";import"@angular/core";import{IonicModule as ui}from"@ionic/angular";import{TranslateModule as hi}from"@ngx-translate/core";import{FormsModule as gi}from"@angular/forms";import*as a from"@angular/core";import*as mt from"@angular/common";import*as _ from"@ionic/angular";import*as H from"@angular/forms";import*as Qt from"@ngx-translate/core";function fi(e,h){if(e&1&&a.\u0275\u0275element(0,"app-game-ln",2),e&2){let t=a.\u0275\u0275nextContext();a.\u0275\u0275property("data",t.game)}}var Ci=(e,h)=>h.number;function vi(e,h){if(e&1&&(a.\u0275\u0275elementStart(0,"ion-item",6)(1,"ion-label",7),a.\u0275\u0275text(2),a.\u0275\u0275pipe(3,"translate"),a.\u0275\u0275elementEnd(),a.\u0275\u0275elementStart(4,"ion-label",8),a.\u0275\u0275text(5),a.\u0275\u0275pipe(6,"currency"),a.\u0275\u0275elementEnd()()),e&2){let t=h.$implicit,i=h.$index;a.\u0275\u0275advance(1),a.\u0275\u0275property("ngClass","result-list-prize-number-"+i),a.\u0275\u0275advance(1),a.\u0275\u0275textInterpolate(a.\u0275\u0275pipeBind1(3,4,t.number)),a.\u0275\u0275advance(2),a.\u0275\u0275property("ngClass","result-list-prize-quantity-"+i),a.\u0275\u0275advance(1),a.\u0275\u0275textInterpolate(a.\u0275\u0275pipeBind2(6,6,t.quantity/100,"EUR"))}}function _i(e,h){if(e&1&&a.\u0275\u0275repeaterCreate(0,vi,7,9,"ion-item",9,Ci),e&2){let t=a.\u0275\u0275nextContext();a.\u0275\u0275repeater(t.results)}}var Wt=(()=>{class e{constructor(t,i){this.cdr=t,this.lnSrv=i,this.debounce=1e3,this.minSearchLength=3,this.environment=f,this.game={},this.gameCodes=S,this.results=[],this.searchValue="",this.bestGamePrizes={}}ionViewDidEnter(){this.searchValue="",this.game=history.state.game,this.formatPrizesNumbers(),this.results=this.game.data.info.prizes,console.log(this.results),this.cdr.detectChanges()}formatPrizesNumbers(){this.game.data.info.prizes.forEach(t=>{t.number=t.number.padStart(5,"?")})}handleInput(t){this.searchValue=t.target.value.toLowerCase(),this.results=this.game.data.info.prizes.filter(i=>i.number.toLowerCase().indexOf(this.searchValue)>-1)}static{this.\u0275fac=function(i){return new(i||e)(a.\u0275\u0275directiveInject(a.ChangeDetectorRef),a.\u0275\u0275directiveInject(st))}}static{this.\u0275cmp=a.\u0275\u0275defineComponent({type:e,selectors:[["app-game-detail"]],standalone:!0,features:[a.\u0275\u0275StandaloneFeature],decls:8,vars:7,consts:[[1,"container"],[1,"game"],[3,"data"],["maxlength","5",1,"search",3,"placeholder","ngModel","debounce","ionInput","ngModelChange"],["slot","start","name","search","aria-hidden","true"],[1,"result-list"],[1,"result-list-prize"],[3,"ngClass"],["slot","end",3,"ngClass"],["class","result-list-prize"]],template:function(i,n){i&1&&(a.\u0275\u0275elementStart(0,"ion-content",0)(1,"section",1),a.\u0275\u0275template(2,fi,1,1,"app-game-ln",2),a.\u0275\u0275elementStart(3,"ion-input",3),a.\u0275\u0275listener("ionInput",function(g){return n.handleInput(g)})("ngModelChange",function(g){return n.searchValue=g}),a.\u0275\u0275pipe(4,"translate"),a.\u0275\u0275element(5,"ion-icon",4),a.\u0275\u0275elementEnd(),a.\u0275\u0275elementStart(6,"ion-list",5),a.\u0275\u0275template(7,_i,2,0),a.\u0275\u0275elementEnd()()()),i&2&&(a.\u0275\u0275advance(2),a.\u0275\u0275conditional(2,n.game&&n.game._id?2:-1),a.\u0275\u0275advance(1),a.\u0275\u0275propertyInterpolate("placeholder",a.\u0275\u0275pipeBind1(4,5,"GLOBAL.SEARCH")),a.\u0275\u0275property("ngModel",n.searchValue)("debounce",n.debounce),a.\u0275\u0275advance(4),a.\u0275\u0275conditional(7,n.results.length?7:-1))},dependencies:[pi,mt.NgClass,mt.CurrencyPipe,ui,_.IonContent,_.IonIcon,_.IonInput,_.IonItem,_.IonLabel,_.IonList,_.TextValueAccessor,gi,H.NgControlStatus,H.MaxLengthValidator,H.NgModel,hi,Qt.TranslatePipe,lt],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{height:100vh;width:100vw;padding-top:50px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]::part(scroll){overscroll-behavior:none;overflow:scroll}[_nghost-%COMP%]   .game[_ngcontent-%COMP%]{display:flex;flex-direction:column;background-color:#fff;box-shadow:#0000003d 0 3px 8px;width:100%;height:100%}[_nghost-%COMP%]   .game[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:flex-start;width:100%;padding:15px 15px 0}[_nghost-%COMP%]   .game[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{margin:15px 15px 0}[_nghost-%COMP%]   .game[_ngcontent-%COMP%]   .result-list[_ngcontent-%COMP%]{margin-bottom:150px;overflow-y:scroll;overscroll-behavior:none}[_nghost-%COMP%]   .game-img[_ngcontent-%COMP%]{width:50px;margin:0 15px 0 0}[_nghost-%COMP%]   .no-results[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:20px}"],changeDetection:0})}}return e})();var Kr=[{path:"",component:Nt,children:[{path:"",redirectTo:"main",pathMatch:"full"},{path:"main",component:At,children:[{path:"games",component:qt},{path:"game-detail-ln",component:Wt},{path:"scan",component:Ot},{path:"tickets",component:Rt},{path:"menu",component:Vt}]}]}];export{Kr as routes};
