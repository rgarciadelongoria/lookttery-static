import{c as m}from"./chunk-POLL2CVR.js";import{bootstrapApplication as _e}from"@angular/platform-browser";import{provideRouter as Ee}from"@angular/router";import{CommonModule as Rt}from"@angular/common";import"@angular/core";import{RouterModule as At}from"@angular/router";import{IonicModule as jt}from"@ionic/angular";var G=function(o){return o.SHELL_VERSION="shellVersion",o}(G||{}),T=function(o){return o.SHELL_DEVICE_GET_ID="shellDeviceGetId",o.SHELL_SCANNER_RESPONSE="shellScannerResponse",o.SHELL_SCANNER_START="shellScannerStart",o.SHELL_SCANNER_STOP="shellScannerStop",o.SHELL_SCANNER_ERROR="shellScannerError",o.SHELL_DEVICE_GET_ID_RESPONSE="shellDeviceGetIdResponse",o}(T||{}),q=function(o){return o.SHELL_LOADING_REMOTE_OK="shellLoadingRemoteOk",o}(q||{});import{ZXingScannerModule as Nt}from"@zxing/ngx-scanner";import{BarcodeFormat as rt}from"@zxing/library";import*as a from"@angular/core";import"@angular/core";import*as R from"@angular/core";import"@angular/core";import*as Y from"@angular/core";var I=(()=>{let i=class i{constructor(){}setItem(t,e){localStorage.setItem(t,e)}getItem(t){try{return JSON.parse(localStorage.getItem(t)||"")}catch{return localStorage.getItem(t)}}removeItem(t){localStorage.removeItem(t)}};i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=Y.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var A=(()=>{let i=class i{constructor(t){this.storageSrv=t}hasShell(){let t="0.0.0";return this.storageSrv.getItem(G.SHELL_VERSION)===t}};i.\u0275fac=function(e){return new(e||i)(R.\u0275\u0275inject(I))},i.\u0275prov=R.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();import*as at from"@angular/router";import"@angular/core";var g={api:{host:"https://api.lookttery.com/api"},web:{host:"https://lookttery.com"}};import{lastValueFrom as et}from"rxjs";var S=function(o){return o.TOKEN="token",o.WEB_UUID="webUuid",o}(S||{}),_=function(o){return o.SYSTEM="[SYSTEM]",o}(_||{}),j=function(o){return o.UUID_EMAIL_DOMAIN="@uuid.app",o}(j||{});var w=function(o){return o.CANCEL="CANCEL",o.ACCEPT="ACCEPT",o}(w||{});import*as M from"@angular/core";import*as it from"@ionic/angular";import*as ot from"@ngx-translate/core";import{HttpHeaders as Pt}from"@angular/common/http";import"@angular/core";import{catchError as Lt,throwError as Ut}from"rxjs";import*as D from"@angular/core";import*as X from"@angular/common/http";import*as J from"@angular/router";var tt=function(o){return o.UNAUTHORIZED="Unauthorized",o}(tt||{}),v=(()=>{let i=class i{constructor(t,e,n){this.http=t,this.router=e,this.storageSrv=n}get(t,e){return e=this.addTokenToHeaders(e),this.http.get(t,e)}post(t,e,n){return n=this.addPostHeaders(n),n=this.addTokenToHeaders(n),this.http.post(t,e,n).pipe(this.handleErrorAndRedirect())}delete(t,e){return e=this.addTokenToHeaders(e),this.http.delete(t,e)}addTokenToHeaders(t){let n=[["Authorization",`Bearer ${this.storageSrv.getItem(S.TOKEN)?.token}`]];return this.addHeaders(n,t)}addPostHeaders(t){let e=[["Content-Type","application/json"]];return this.addHeaders(e,t)}addHeaders(t,e){return t.forEach(n=>{e=e||{},e.headers=e.headers||{},e.headers instanceof Pt?e.headers=e.headers.append(n[0],n[1]):typeof e.headers=="object"&&(e.headers[n[0]]=n[1])}),e||{}}handleErrorAndRedirect(){return Lt((t,e)=>m(this,null,function*(){return t.status===401&&t.statusText===tt.UNAUTHORIZED&&(this.storageSrv.removeItem(S.TOKEN),this.router.navigate(["/","main"])),Ut(t)}))}};i.\u0275fac=function(e){return new(e||i)(D.\u0275\u0275inject(X.HttpClient),D.\u0275\u0275inject(J.Router),D.\u0275\u0275inject(I))},i.\u0275prov=D.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var x=(()=>{let i=class i{constructor(t,e,n){this.alertController=t,this.translateSrv=e,this.apiSrv=n,this.apiTicket=`${g.api.host}/ticket`}createNewTicket(t){return m(this,null,function*(){let e={data:{info:{code:t}}};try{let n=this.apiSrv.post(this.apiTicket,e);return yield et(n)}catch(n){throw n}})}deleteTicketById(t,e=!1){return m(this,null,function*(){let n=w.ACCEPT;if(e&&(n=yield this.presentAlertConfirmDeleteTicket()),n===w.ACCEPT)try{let s=yield this.apiSrv.delete(`${this.apiTicket}/${t}`);return yield et(s)}catch(s){throw s}})}presentAlertConfirmDeleteTicket(){return m(this,null,function*(){let t=yield this.alertController.create({header:this.translateSrv.instant("TICKETS.DELETE_TICKET"),subHeader:this.translateSrv.instant("GLOBAL.IRREVERSIBLE_ACTION"),message:this.translateSrv.instant("TICKETS.DELETE_TICKET_QUESTION"),buttons:[{text:this.translateSrv.instant("GLOBAL.CANCEL"),role:w.CANCEL,handler:()=>{}},{text:this.translateSrv.instant("GLOBAL.ACCEPT"),role:w.ACCEPT,handler:()=>{}}]});yield t.present();let{role:e}=yield t.onDidDismiss();return e})}};i.\u0275fac=function(e){return new(e||i)(M.\u0275\u0275inject(it.AlertController),M.\u0275\u0275inject(ot.TranslateService),M.\u0275\u0275inject(v))},i.\u0275prov=M.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();import*as st from"@ionic/angular";import*as ct from"@zxing/ngx-scanner";function Ht(o,i){o&1&&(a.\u0275\u0275elementStart(0,"article"),a.\u0275\u0275text(1,"Camera permission denied."),a.\u0275\u0275elementEnd())}function Bt(o,i){o&1&&a.\u0275\u0275element(0,"ion-icon",2)}function $t(o,i){if(o&1){let h=a.\u0275\u0275getCurrentView();a.\u0275\u0275elementStart(0,"zxing-scanner",3,4),a.\u0275\u0275listener("scanSuccess",function(e){a.\u0275\u0275restoreView(h);let n=a.\u0275\u0275nextContext();return a.\u0275\u0275resetView(n.startScan(e))})("permissionResponse",function(e){a.\u0275\u0275restoreView(h);let n=a.\u0275\u0275nextContext();return a.\u0275\u0275resetView(n.permissionResponse(e))}),a.\u0275\u0275elementEnd()}if(o&2){let h=a.\u0275\u0275nextContext();a.\u0275\u0275property("formats",h.allowedFormats)}}var lt=(()=>{let i=class i{handleShellScannerResponse(t){return m(this,null,function*(){yield this.onScannerResponse(t.detail?.response||{})})}handleShellScannerError(t){return m(this,null,function*(){yield this.onScannerError(t.detail?.response||{})})}constructor(t,e,n){this.coreSrv=t,this.router=e,this.ticketSrv=n,this.hasShell=!1,this.responses=[],this.hasPermission=!0,this.allowedFormats=[rt.CODE_128,rt.QR_CODE]}ngOnInit(){}ionViewDidEnter(){return m(this,null,function*(){this.hasShell=this.coreSrv.hasShell()||!1,yield this.startScan()})}ionViewWillLeave(){this.stopScan()}startScan(t){return m(this,null,function*(){this.hasPermission=!0,t&&!this.hasShell?yield this.onScannerResponse(t||{}):this.hasShell&&window.dispatchEvent(new CustomEvent(T.SHELL_SCANNER_START))})}stopScan(t){this.hasShell&&window.dispatchEvent(new CustomEvent(T.SHELL_SCANNER_STOP))}permissionResponse(t){this.hasPermission=t||!1}onScannerResponse(t){return m(this,null,function*(){let e=yield this.ticketSrv.createNewTicket(t.content||t||"");this.exit()})}onScannerError(t){return m(this,null,function*(){console.log(t),this.hasPermission=!1})}exit(){this.router.navigate(["/main/","tickets"])}};i.\u0275fac=function(e){return new(e||i)(a.\u0275\u0275directiveInject(A),a.\u0275\u0275directiveInject(at.Router),a.\u0275\u0275directiveInject(x))},i.\u0275cmp=a.\u0275\u0275defineComponent({type:i,selectors:[["app-scan"]],hostBindings:function(e,n){e&1&&a.\u0275\u0275listener("shellScannerResponse",function(u){return n.handleShellScannerResponse(u)},!1,a.\u0275\u0275resolveWindow)("shellScannerError",function(u){return n.handleShellScannerError(u)},!1,a.\u0275\u0275resolveWindow)},standalone:!0,features:[a.\u0275\u0275StandaloneFeature],decls:5,vars:1,consts:[[1,"scan"],[1,"scan-screen"],["name","add-outline",1,"scan-screen-pointer"],[3,"formats","scanSuccess","permissionResponse"],["scanner",""]],template:function(e,n){e&1&&(a.\u0275\u0275elementStart(0,"section",0)(1,"section",1),a.\u0275\u0275template(2,Ht,2,0,"article")(3,Bt,1,0)(4,$t,2,1),a.\u0275\u0275elementEnd()()),e&2&&(a.\u0275\u0275advance(2),a.\u0275\u0275conditional(2,n.hasPermission?n.hasShell?3:n.hasShell?-1:4:2))},dependencies:[Rt,At,jt,st.IonIcon,Nt,ct.ZXingScannerComponent],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   .scan[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:flex-start;height:100vh;margin:0}[_nghost-%COMP%]   .scan-controls[_ngcontent-%COMP%]{width:100%;padding:20px}[_nghost-%COMP%]   .scan-controls[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:44px}[_nghost-%COMP%]   .scan-screen[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%}[_nghost-%COMP%]   .scan-screen-pointer[_ngcontent-%COMP%]{width:40px;color:#fff;height:40px}"],changeDetection:0});let o=i;return o})();import{CommonModule as Ft}from"@angular/common";import"@angular/core";import{RouterModule as Vt}from"@angular/router";import{IonicModule as Kt}from"@ionic/angular";import{TranslateModule as zt}from"@ngx-translate/core";import*as l from"@angular/core";import*as C from"@ionic/angular";import*as mt from"@ngx-translate/core";var Gt=["mainTabs"],pt=(()=>{let i=class i{constructor(){}ngOnInit(){}ngAfterViewInit(){setTimeout(()=>{this.mainTabs.select("tickets")},500)}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=l.\u0275\u0275defineComponent({type:i,selectors:[["app-main"]],viewQuery:function(e,n){if(e&1&&l.\u0275\u0275viewQuery(Gt,5),e&2){let s;l.\u0275\u0275queryRefresh(s=l.\u0275\u0275loadQuery())&&(n.mainTabs=s.first)}},standalone:!0,features:[l.\u0275\u0275StandaloneFeature],decls:13,vars:3,consts:[["mainTabs",""],["slot","bottom"],["tab","scan"],["name","scan-outline"],["tab","tickets"],["name","wallet-outline"]],template:function(e,n){e&1&&(l.\u0275\u0275element(0,"ion-router-outlet"),l.\u0275\u0275elementStart(1,"ion-tabs",null,0)(3,"ion-tab-bar",1)(4,"ion-tab-button",2),l.\u0275\u0275element(5,"ion-icon",3),l.\u0275\u0275elementStart(6,"span"),l.\u0275\u0275text(7),l.\u0275\u0275pipe(8,"translate"),l.\u0275\u0275elementEnd()(),l.\u0275\u0275elementStart(9,"ion-tab-button",4),l.\u0275\u0275element(10,"ion-icon",5),l.\u0275\u0275elementStart(11,"span"),l.\u0275\u0275text(12,"Tickets"),l.\u0275\u0275elementEnd()()()()),e&2&&(l.\u0275\u0275advance(7),l.\u0275\u0275textInterpolate(l.\u0275\u0275pipeBind1(8,1,"MAIN.SCAN_NOW")))},dependencies:[Ft,Vt,Kt,C.IonIcon,C.IonTabBar,C.IonTabButton,C.IonTabs,C.IonRouterOutlet,zt,mt.TranslatePipe],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   ion-tab-bar[_ngcontent-%COMP%]{padding-bottom:var(--ion-statusbar-padding, 0)}"],changeDetection:0});let o=i;return o})();import{CommonModule as Xt}from"@angular/common";import{HttpClient as Jt,HttpClientModule as te}from"@angular/common/http";import"@angular/core";import{NavigationEnd as ee,RouterModule as ie}from"@angular/router";import{filter as oe}from"rxjs";import{IonicModule as ne}from"@ionic/angular";import"@angular/core";import{lastValueFrom as dt}from"rxjs";import{v4 as Qt}from"uuid";import*as b from"@angular/core";import"@angular/core";import{lastValueFrom as Q}from"rxjs";import*as L from"@angular/core";var qt=1e3*60*60*1.5,E=(()=>{let i=class i{constructor(t,e){this.apiSrv=t,this.storageSrv=e,this.apiUser=`${g.api.host}/user`}createUserByUuid(t){return m(this,null,function*(){let e={email:`${t}${j.UUID_EMAIL_DOMAIN}`,password:t,name:t};try{let n=this.apiSrv.post(this.apiUser,e);return yield Q(n)}catch(n){throw n}})}loginByUuid(t){return m(this,null,function*(){return yield this.login(`${t}${j.UUID_EMAIL_DOMAIN}`,t)})}login(t,e){return m(this,null,function*(){let n={email:t,password:e};try{let s=this.apiSrv.post(`${this.apiUser}/login`,n),u=yield Q(s);if(u.token){let Ot={token:u.token,date:Date.now()};this.storageSrv.setItem(S.TOKEN,JSON.stringify(Ot)),console.info(_.SYSTEM,`${u.token}`)}return u}catch(s){throw s}})}checkTokenExpiration(t){return m(this,null,function*(){let n=this.storageSrv.getItem(S.TOKEN)?.date||0;Date.now()-n>qt&&(yield this.loginByUuid(t))})}getAllTicketsByUser(){return m(this,null,function*(){try{let t=this.apiSrv.get(`${this.apiUser}/ticket/all?limit=100&offset=0`);return yield Q(t)}catch{return[]}})}};i.\u0275fac=function(e){return new(e||i)(L.\u0275\u0275inject(v),L.\u0275\u0275inject(I))},i.\u0275prov=L.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var O=(()=>{let i=class i{constructor(t,e,n){this.apiSrv=t,this.userSrv=e,this.coreSrv=n,this.uuid="",this.apiUuid=`${g.api.host}/uuid`,window.addEventListener(T.SHELL_DEVICE_GET_ID_RESPONSE,s=>m(this,null,function*(){let u=localStorage.getItem(S.WEB_UUID)||s.detail?.response||"";this.setAppUuid(u),yield this.onDeviceIdResponse()}))}init(){return m(this,null,function*(){yield this.requestDeviceId()})}getUuid(){return this.uuid}requestDeviceId(){return m(this,null,function*(){if(this.coreSrv.hasShell())window.dispatchEvent(new CustomEvent(T.SHELL_DEVICE_GET_ID));else{let t=localStorage.getItem(S.WEB_UUID)||"";this.setAppUuid(t),yield this.onDeviceIdResponse()}})}setAppUuid(t){this.uuid=t,this.uuid||(this.uuid=Qt(),localStorage.setItem(S.WEB_UUID,this.uuid))}onDeviceIdResponse(){return m(this,null,function*(){(yield this.getUuidData())?(yield this.userSrv.loginByUuid(this.uuid),console.info(_.SYSTEM,`UUID ${this.uuid} was registered.`)):yield this.registerUuid()})}getUuidData(){return m(this,null,function*(){try{let t=this.apiSrv.get(`${this.apiUuid}/${this.uuid}`);return yield dt(t)}catch{return null}})}registerUuid(){return m(this,null,function*(){let t=yield this.userSrv.createUserByUuid(this.uuid);if((yield this.userSrv.loginByUuid(this.uuid)).token){let n={uuid:this.uuid,user:t._id};try{let s=this.apiSrv.post(this.apiUuid,n),u=yield dt(s);this.uuid=u.uuid,console.info(_.SYSTEM,`UUID ${this.uuid} has been registered.`)}catch(s){console.error(s)}}})}};i.\u0275fac=function(e){return new(e||i)(b.\u0275\u0275inject(v),b.\u0275\u0275inject(E),b.\u0275\u0275inject(A))},i.\u0275prov=b.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();import{TranslateLoader as re,TranslateModule as ae}from"@ngx-translate/core";import"@angular/core";import{catchError as Wt}from"rxjs/operators";import*as H from"@angular/core";import*as ht from"@angular/common/http";var ft=(()=>{let i=class i{constructor(t){this.httpClient=t}getTranslation(t){let e=g.web.host+`/assets/i18n/${t}.json`;return this.httpClient.get(e).pipe(Wt(n=>(console.log("Error loading translation file",n),this.httpClient.get(g.web.host+"/assets/i18n/es.json"))))}};i.\u0275fac=function(e){return new(e||i)(H.\u0275\u0275inject(ht.HttpClient))},i.\u0275prov=H.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac});let o=i;return o})();import"@angular/core";import{lastValueFrom as Yt}from"rxjs";import*as B from"@angular/core";var $=(()=>{let i=class i{constructor(t){this.apiSrv=t,this.apiGame=`${g.api.host}/game`}getAllTicketsPrizesByUser(){return m(this,null,function*(){try{let t=this.apiSrv.get(`${this.apiGame}/ticket/all?limit=100&offset=0`);return yield Yt(t)}catch{return[]}})}};i.\u0275fac=function(e){return new(e||i)(B.\u0275\u0275inject(v))},i.\u0275prov=B.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();import*as f from"@angular/core";import*as gt from"@ngx-translate/core";import*as F from"@angular/router";var St=(()=>{let i=class i{constructor(t,e,n,s,u){this.translateSrv=t,this.uuidSrv=e,this.userSrv=n,this.storageSrv=s,this.router=u,this.translateSrv.setDefaultLang("en"),this.translateSrv.use("en")}ngOnInit(){this.setNoErrorLoadingRemote(),this.importStyles(),this.importScripts(),this.uuidSrv.init(),this.router.events.pipe(oe(t=>t instanceof ee)).subscribe(t=>{let e=this.uuidSrv.getUuid();e?this.userSrv.checkTokenExpiration(e):this.uuidSrv.init()})}setNoErrorLoadingRemote(){this.storageSrv.setItem(q.SHELL_LOADING_REMOTE_OK,!0)}importScripts(){let t=["https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.esm.js","https://cdn.jsdelivr.net/npm/ionicons/dist/ionicons/ionicons.esm.js"],e=document.head;t.forEach(n=>{let s=document.createElement("script");s.type="module",s.src=n,s.async=!1,document.head.appendChild(s),e.insertBefore(s,e.firstElementChild)})}importStyles(){let t=["https://cdn.jsdelivr.net/npm/@ionic/core/css/ionic.bundle.css"],e=document.head;t.forEach(n=>{let s=document.createElement("link");s.rel="stylesheet",s.href=n,e.insertBefore(s,e.firstElementChild)})}};i.\u0275fac=function(e){return new(e||i)(f.\u0275\u0275directiveInject(gt.TranslateService),f.\u0275\u0275directiveInject(O),f.\u0275\u0275directiveInject(E),f.\u0275\u0275directiveInject(I),f.\u0275\u0275directiveInject(F.Router))},i.\u0275cmp=f.\u0275\u0275defineComponent({type:i,selectors:[["app-remote-app"]],standalone:!0,features:[f.\u0275\u0275ProvidersFeature([v,O,E,x,$,ae.forRoot({loader:{provide:re,useClass:ft,deps:[Jt]}}).providers]),f.\u0275\u0275StandaloneFeature],decls:1,vars:0,template:function(e,n){e&1&&f.\u0275\u0275element(0,"router-outlet")},dependencies:[Xt,ie,F.RouterOutlet,ne,te],styles:[`:host{display:block}body{--ion-color-primary: #3880ff;--ion-color-primary-rgb: 56,128,255;--ion-color-primary-contrast: #000000;--ion-color-primary-contrast-rgb: 0,0,0;--ion-color-primary-shade: #3171e0;--ion-color-primary-tint: #4c8dff;--ion-color-secondary: #3dc2ff;--ion-color-secondary-rgb: 61,194,255;--ion-color-secondary-contrast: #000000;--ion-color-secondary-contrast-rgb: 0,0,0;--ion-color-secondary-shade: #36abe0;--ion-color-secondary-tint: #50c8ff;--ion-color-tertiary: #5260ff;--ion-color-tertiary-rgb: 82,96,255;--ion-color-tertiary-contrast: #ffffff;--ion-color-tertiary-contrast-rgb: 255,255,255;--ion-color-tertiary-shade: #4854e0;--ion-color-tertiary-tint: #6370ff;--ion-color-success: #2dd36f;--ion-color-success-rgb: 45,211,111;--ion-color-success-contrast: #000000;--ion-color-success-contrast-rgb: 0,0,0;--ion-color-success-shade: #28ba62;--ion-color-success-tint: #42d77d;--ion-color-warning: #ffc409;--ion-color-warning-rgb: 255,196,9;--ion-color-warning-contrast: #000000;--ion-color-warning-contrast-rgb: 0,0,0;--ion-color-warning-shade: #e0ac08;--ion-color-warning-tint: #ffca22;--ion-color-danger: #eb445a;--ion-color-danger-rgb: 235,68,90;--ion-color-danger-contrast: #000000;--ion-color-danger-contrast-rgb: 0,0,0;--ion-color-danger-shade: #cf3c4f;--ion-color-danger-tint: #ed576b;--ion-color-light: #f4f5f8;--ion-color-light-rgb: 244,245,248;--ion-color-light-contrast: #000000;--ion-color-light-contrast-rgb: 0,0,0;--ion-color-light-shade: #d7d8da;--ion-color-light-tint: #f5f6f9;--ion-color-medium: #92949c;--ion-color-medium-rgb: 146,148,156;--ion-color-medium-contrast: #000000;--ion-color-medium-contrast-rgb: 0,0,0;--ion-color-medium-shade: #808289;--ion-color-medium-tint: #9d9fa6;--ion-color-dark: #222428;--ion-color-dark-rgb: 34,36,40;--ion-color-dark-contrast: #ffffff;--ion-color-dark-contrast-rgb: 255,255,255;--ion-color-dark-shade: #1e2023;--ion-color-dark-tint: #383a3e}
`],encapsulation:2,changeDetection:0});let o=i;return o})();import{CommonModule as pe}from"@angular/common";import"@angular/core";import{RouterModule as de}from"@angular/router";import{IonicModule as ue}from"@ionic/angular";import{CommonModule as se}from"@angular/common";import"@angular/core";import{IonicModule as ce}from"@ionic/angular";import*as c from"@angular/core";import*as vt from"@angular/router";import*as Ct from"@ngx-translate/core";import*as yt from"@angular/common";import*as y from"@ionic/angular";function le(o,i){if(o&1){let h=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"ion-button",3),c.\u0275\u0275listener("click",function(){c.\u0275\u0275restoreView(h);let e=c.\u0275\u0275nextContext();return c.\u0275\u0275resetView(e.openMenu())}),c.\u0275\u0275text(1,"MENU"),c.\u0275\u0275elementEnd()}}var V=(()=>{let i=class i{constructor(t,e,n){this.router=t,this.cdr=e,this.translateSrv=n,this.showMenu=!0}changeLanguage(t){this.translateSrv.use(t),this.cdr.detectChanges()}openMenu(){this.router.navigate(["/main/","menu"])}};i.\u0275fac=function(e){return new(e||i)(c.\u0275\u0275directiveInject(vt.Router),c.\u0275\u0275directiveInject(c.ChangeDetectorRef),c.\u0275\u0275directiveInject(Ct.TranslateService))},i.\u0275cmp=c.\u0275\u0275defineComponent({type:i,selectors:[["app-header"]],inputs:{showMenu:"showMenu"},standalone:!0,features:[c.\u0275\u0275StandaloneFeature],decls:6,vars:1,consts:[["color","primary"],["slot","end"],[3,"click",4,"ngIf"],[3,"click"]],template:function(e,n){e&1&&(c.\u0275\u0275elementStart(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),c.\u0275\u0275text(3,"Lookttery"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(4,"ion-buttons",1),c.\u0275\u0275template(5,le,2,0,"ion-button",2),c.\u0275\u0275elementEnd()()()),e&2&&(c.\u0275\u0275advance(5),c.\u0275\u0275property("ngIf",n.showMenu))},dependencies:[se,yt.NgIf,ce,y.IonButton,y.IonButtons,y.IonHeader,y.IonTitle,y.IonToolbar],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--padding-top: calc(var(--ion-statusbar-padding, 0) + var(--ion-statusbar-padding, 0))}"],changeDetection:0});let o=i;return o})();import"@angular/core";import{BehaviorSubject as me}from"rxjs";import*as K from"@angular/core";import*as It from"@ngx-translate/core";var Et=(()=>{let i=class i{constructor(t){this.translateService=t}transform(t){let e=new Date(t),n={weekday:"long",year:"numeric",month:"long",day:"numeric"},s=e.toLocaleDateString(this.translateService.currentLang,n),u=new me(s);return this.translateService.onLangChange.subscribe(()=>(s=e.toLocaleDateString(this.translateService.currentLang,n),u.next(s))),u}};i.\u0275fac=function(e){return new(e||i)(K.\u0275\u0275directiveInject(It.TranslateService,16))},i.\u0275pipe=K.\u0275\u0275definePipe({name:"date",type:i,pure:!0,standalone:!0});let o=i;return o})();import*as r from"@angular/core";import*as z from"@angular/common";import*as d from"@ionic/angular";var he=(o,i)=>i.ticket._id;function fe(o,i){if(o&1){let h=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementStart(0,"ion-item-sliding")(1,"ion-item",2)(2,"ion-label",3)(3,"ion-note",4),r.\u0275\u0275text(4),r.\u0275\u0275pipe(5,"async"),r.\u0275\u0275pipe(6,"date"),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(7,"section",5),r.\u0275\u0275element(8,"ion-img",6),r.\u0275\u0275elementStart(9,"strong",7),r.\u0275\u0275text(10),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(11,"span",8),r.\u0275\u0275text(12),r.\u0275\u0275pipe(13,"currency"),r.\u0275\u0275elementEnd()()()(),r.\u0275\u0275elementStart(14,"ion-item-options",9)(15,"ion-item-option",10),r.\u0275\u0275listener("click",function(){let n=r.\u0275\u0275restoreView(h).$implicit,s=r.\u0275\u0275nextContext();return r.\u0275\u0275resetView(s.deleteTicketById(n.ticket._id||""))}),r.\u0275\u0275element(16,"ion-icon",11),r.\u0275\u0275elementEnd()()()}if(o&2){let h=i.$implicit,t=r.\u0275\u0275nextContext();r.\u0275\u0275advance(1),r.\u0275\u0275property("button",!0),r.\u0275\u0275advance(3),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind1(5,5,r.\u0275\u0275pipeBind1(6,7,h.ticket.date))),r.\u0275\u0275advance(4),r.\u0275\u0275property("src",t.environment.web.host+"/assets/logos/games/"+h.ticket.code+".png"),r.\u0275\u0275advance(2),r.\u0275\u0275textInterpolate(h.ticket.data.info.number),r.\u0275\u0275advance(2),r.\u0275\u0275textInterpolate(r.\u0275\u0275pipeBind2(13,9,h.prize.quantity/100,"EUR"))}}function ge(o,i){o&1&&(r.\u0275\u0275elementStart(0,"p"),r.\u0275\u0275text(1,"Empty list of tickets"),r.\u0275\u0275elementEnd())}var kt=(()=>{let i=class i{constructor(t,e,n,s){this.cdr=t,this.userSrv=e,this.ticketSrv=n,this.gameSrv=s,this.tickets=[],this.environment=g}ngOnInit(){}ionViewDidEnter(){return m(this,null,function*(){yield this.getUserTickets(),this.sortTicketsByDate()})}sortTicketsByDate(){this.tickets.sort((t,e)=>{let n=new Date(t.ticket.date);return new Date(e.ticket.date).getTime()-n.getTime()}),this.cdr.detectChanges()}deleteTicketById(t){return m(this,null,function*(){yield this.ticketSrv.deleteTicketById(t,!0),yield this.getUserTickets()})}getUserTickets(){return m(this,null,function*(){this.tickets=yield this.gameSrv.getAllTicketsPrizesByUser(),this.cdr.detectChanges(),console.log(this.tickets)})}};i.\u0275fac=function(e){return new(e||i)(r.\u0275\u0275directiveInject(r.ChangeDetectorRef),r.\u0275\u0275directiveInject(E),r.\u0275\u0275directiveInject(x),r.\u0275\u0275directiveInject($))},i.\u0275cmp=r.\u0275\u0275defineComponent({type:i,selectors:[["app-tickets"]],standalone:!0,features:[r.\u0275\u0275StandaloneFeature],decls:6,vars:1,consts:[["padding","","color","light"],[1,"ticket-list"],[1,"ticket-item",3,"button"],[1,"ticket-item-text"],["color","medium"],[1,"game-item-data"],["aria-hidden","true","slot","start","alt","",1,"game-item-img",3,"src"],[1,"game-item-data-number"],[1,"game-item-prize"],["slot","end"],["color","danger","expandable","true",3,"click"],["slot","icon-only","name","trash"]],template:function(e,n){e&1&&(r.\u0275\u0275element(0,"app-header"),r.\u0275\u0275elementStart(1,"ion-content",0)(2,"ion-list",1),r.\u0275\u0275repeaterCreate(3,fe,17,12,"ion-item-sliding",null,he,!1,ge,2,0),r.\u0275\u0275elementEnd()()),e&2&&(r.\u0275\u0275advance(3),r.\u0275\u0275repeater(n.tickets))},dependencies:[pe,z.AsyncPipe,z.CurrencyPipe,de,ue,d.IonContent,d.IonIcon,d.IonImg,d.IonItem,d.IonItemOption,d.IonItemOptions,d.IonItemSliding,d.IonLabel,d.IonList,d.IonNote,V,Et],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{height:100vh;width:100vw;padding-top:50px}[_nghost-%COMP%]   .ticket-list[_ngcontent-%COMP%]{margin-bottom:150px}[_nghost-%COMP%]   .ticket-list[_ngcontent-%COMP%]   .ticket-item[_ngcontent-%COMP%]   .ticket-item-text[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .ticket-list[_ngcontent-%COMP%]   .ticket-item[_ngcontent-%COMP%]   .ticket-item-text[_ngcontent-%COMP%]   .game-item-img[_ngcontent-%COMP%]{width:40px;height:40px}[_nghost-%COMP%]   .ticket-list[_ngcontent-%COMP%]   .ticket-item[_ngcontent-%COMP%]   .ticket-item-text[_ngcontent-%COMP%]   .game-item-data[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:calc(100% - 45px);align-items:center;margin-top:12px}[_nghost-%COMP%]   .ticket-list[_ngcontent-%COMP%]   .ticket-item[_ngcontent-%COMP%]   .ticket-item-text[_ngcontent-%COMP%]   .game-item-data[_ngcontent-%COMP%]   .game-item-data-number[_ngcontent-%COMP%]{letter-spacing:15px;font-size:30px;display:block;width:100%;padding-left:12px}"],changeDetection:0});let o=i;return o})();import{CommonModule as Se}from"@angular/common";import"@angular/core";import{IonicModule as ve}from"@ionic/angular";import{QrCodeModule as Ce}from"ng-qrcode";import{RouterModule as ye}from"@angular/router";import*as p from"@angular/core";import*as Tt from"@angular/common";import*as k from"@ionic/angular";import*as _t from"ng-qrcode";function Ie(o,i){if(o&1&&p.\u0275\u0275element(0,"qr-code",4),o&2){let h=p.\u0275\u0275nextContext();p.\u0275\u0275property("value",h.qrUuid)}}var wt=(()=>{let i=class i{constructor(t,e){this.cdr=t,this.uuidSrv=e,this.qrUuid="aaa"}ngOnInit(){this.qrUuid=this.uuidSrv.getUuid(),this.cdr.detectChanges()}};i.\u0275fac=function(e){return new(e||i)(p.\u0275\u0275directiveInject(p.ChangeDetectorRef),p.\u0275\u0275directiveInject(O))},i.\u0275cmp=p.\u0275\u0275defineComponent({type:i,selectors:[["app-menu"]],standalone:!0,features:[p.\u0275\u0275StandaloneFeature],decls:7,vars:3,consts:[[3,"showMenu"],["padding","","color","light"],[1,"menu-list"],["size","300","errorCorrectionLevel","M",3,"value",4,"ngIf"],["size","300","errorCorrectionLevel","M",3,"value"]],template:function(e,n){e&1&&(p.\u0275\u0275element(0,"app-header",0),p.\u0275\u0275elementStart(1,"ion-content",1)(2,"ion-list",2)(3,"ion-item"),p.\u0275\u0275template(4,Ie,1,1,"qr-code",3),p.\u0275\u0275elementStart(5,"ion-label"),p.\u0275\u0275text(6),p.\u0275\u0275elementEnd()()()()),e&2&&(p.\u0275\u0275property("showMenu",!1),p.\u0275\u0275advance(4),p.\u0275\u0275property("ngIf",n.qrUuid),p.\u0275\u0275advance(2),p.\u0275\u0275textInterpolate(n.qrUuid))},dependencies:[Se,Tt.NgIf,ve,k.IonContent,k.IonItem,k.IonLabel,k.IonList,ye,Ce,_t.QrCodeComponent,V],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{height:100vh;width:100vw;padding-top:50px}"],changeDetection:0});let o=i;return o})();var Dt=[{path:"",component:St,children:[{path:"",redirectTo:"main",pathMatch:"full"},{path:"main",component:pt,children:[{path:"scan",component:lt},{path:"tickets",component:kt},{path:"menu",component:wt}]}]}];var Mt={providers:[Ee(Dt)]};import"@angular/core";import{CommonModule as ke}from"@angular/common";import{RouterModule as Te}from"@angular/router";import*as P from"@angular/core";import*as xt from"@angular/router";var bt=(()=>{let i=class i{constructor(){this.title="lookttery-app"}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=P.\u0275\u0275defineComponent({type:i,selectors:[["app-root"]],standalone:!0,features:[P.\u0275\u0275StandaloneFeature],decls:1,vars:0,template:function(e,n){e&1&&P.\u0275\u0275element(0,"router-outlet")},dependencies:[ke,Te,xt.RouterOutlet]});let o=i;return o})();_e(bt,Mt).catch(o=>console.error(o));
